function [fx,fy,fz] = harmonic_basis_gradient(order)
% gradient of spherical harmonics in x-y-z
%
% Hai 07/23/20

if order >= 1
    fx{1}{1} = @(x,y,z) ones(size(x));     fy{1}{1} = @(x,y,z) zeros(size(x));      fz{1}{1} = @(x,y,z) zeros(size(x));
end

if order >= 2
    fx{2}{1} = @(x,y,z) z;     fy{2}{1} = @(x,y,z) zeros(size(x));      fz{2}{1} = @(x,y,z) x;
    fx{2}{2} = @(x,y,z) 2*x;     fy{2}{2} = @(x,y,z) -2*y;                  fz{2}{2} = @(x,y,z) zeros(size(x)); 
end

if order >= 3
    fx{3}{1} = @(x,y,z) -3*x.^2-y.^2+4*z.^2;    fy{3}{1} = @(x,y,z) -2*x.*y;    fz{3}{1} = @(x,y,z) 8*x.*z;
    fx{3}{2} = @(x,y,z) 2*x.*z;                 fy{3}{2} = @(x,y,z) -2*y.*z;    fz{3}{2} = @(x,y,z) x.^2-y.^2;
    fx{3}{3} = @(x,y,z) 3*(x.^2-y.^2);              fy{3}{3} = @(x,y,z) -6*x.*y;    fz{3}{3} = @(x,y,z) zeros(size(x)); 
end

if order >= 4
    fx{4}{1} = @(x,y,z) -9*x.^2.*z-3*y.^2.*z+4*z.^3;    fy{4}{1} = @(x,y,z) -6*x.*y.*z;        fz{4}{1} = @(x,y,z) -3*x.^3-3*x.*y.^2+12*x.*z.^2;
    fx{4}{2} = @(x,y,z) -4*x.^3+12*x.*z.^2;                fy{4}{2} = @(x,y,z) 4*y.^3-12*y.*z.^2;    fz{4}{2} = @(x,y,z) 12*x.^2.*z-12*y.^2.*z;
    fx{4}{3} = @(x,y,z) 3*x.^2.*z-3*y.^2.*z;            fy{4}{3} = @(x,y,z) -6*x.*y.*z;        fz{4}{3} = @(x,y,z) x.^3-3*x.*y.^2;
    fx{4}{4} = @(x,y,z) 4*(x.^3-3*x.*y.^2);                 fy{4}{4} = @(x,y,z) 4*(y.^3-3*x.^2.*y);    fz{4}{4} = @(x,y,z) zeros(size(x));
end

if order >= 5
    fx{5}{1} = @(x,y,z) 5*x.^4+y.^4-12*y.^2.*z.^2+8*z.^4+6*x.^2.*(y.^2-6*z.^2);  fy{5}{1} = @(x,y,z) 4*x.*y.*(x.^2+y.^2-6*z.^2);  fz{5}{1} = @(x,y,z) -8*x.*z.*(3*x.^2+3*y.^2-4*z.^2);
    fx{5}{2} = @(x,y,z) -4*x.^3.*z+4*x.*z.^3;  fy{5}{2} = @(x,y,z) 4*y.*z.*(y.^2-z.^2);  fz{5}{2} = @(x,y,z) -(x.^2-y.^2).*(x.^2+y.^2-6*z.^2);
    fx{5}{3} = @(x,y,z) -5*x.^4+6*x.^2.*(y.^2+4*z.^2)+3*(y.^4-8*y.^2.*z.^2);  fy{5}{3} = @(x,y,z) 4*x.*y.*(x.^2+3*(y.^2-4*z.^2));  fz{5}{3} = @(x,y,z) 16*(x.^3-3*x.*y.^2).*z;
    fx{5}{4} = @(x,y,z) 4*(x.^3-3*x.*y.^2).*z;  fy{5}{4} = @(x,y,z) 4*y.*(-3*x.^2+y.^2).*z;  fz{5}{4} = @(x,y,z) x.^4-6*x.^2.*y.^2+y.^4;
    fx{5}{5} = @(x,y,z) 5*(x.^4-6*x.^2.*y.^2+y.^4); fy{5}{5} = @(x,y,z) 20*x.*y.*(-x.^2+y.^2); fz{5}{5} = @(x,y,z) zeros(size(x));
end

if order >= 6
    fx{6}{1} = @(x,y,z) z.*(25*x.^4+5*y.^4-20*y.^2.*z.^2+8*z.^4+30*x.^2.*(y.^2-2*z.^2));  fy{6}{1} = @(x,y,z) 20*x.*y.*z.*(x.^2+y.^2-2*z.^2);  fz{6}{1} = @(x,y,z) 5*x.*(21*z.^4-14*z.^2.*(x.^2+y.^2+z.^2)+(x.^2+y.^2+z.^2).^2);
    fx{6}{2} = @(x,y,z) 2*x.*(3*x.^4-y.^4+16*z.^4+2*x.^2.*(y.^2-16*z.^2));  fy{6}{2} = @(x,y,z) 2*y.*(x.^4-2*x.^2.*y.^2-3*y.^4+32*y.^2.*z.^2-16*z.^4);  fz{6}{2} = @(x,y,z) -32*(x.^2-y.^2).*z.*(x.^2+y.^2-2*z.^2);
    fx{6}{3} = @(x,y,z) 3*z.*(-5*x.^4+3*y.^4-8*y.^2.*z.^2+x.^2.*(6*y.^2+8*z.^2));  fy{6}{3} = @(x,y,z) 12*x.*y.*z.*(x.^2+3*y.^2-4*z.^2);  fz{6}{3} = @(x,y,z) -3*(x.^3-3*x.*y.^2).*(x.^2+y.^2-8*z.^2);
    fx{6}{4} = @(x,y,z) -6*x.^5+20*x.^3.*(y.^2+2*z.^2)+10*x.*(y.^4-12*y.^2.*z.^2);  fy{6}{4} = @(x,y,z) 2*y.*(5*x.^4-3*y.^4+20*y.^2.*z.^2+10*x.^2.*(y.^2-6*z.^2));  fz{6}{4} = @(x,y,z) 20*(x.^4-6*x.^2.*y.^2+y.^4).*z;
    fx{6}{5} = @(x,y,z) 5*(x.^4-6*x.^2.*y.^2+y.^4).*z;  fy{6}{5} = @(x,y,z) -20*x.*y.*(x.^2-y.^2).*z;  fz{6}{5} = @(x,y,z) x.^5-10*x.^3.*y.^2+5*x.*y.^4;
    fx{6}{6} = @(x,y,z) 6*(x.^5-10*x.^3.*y.^2+5*x.*y.^4);  fy{6}{6} = @(x,y,z) -6*(5*x.^4.*y-10*x.^2.*y.^3+y.^5);  fz{6}{6} = @(x,y,z) zeros(size(x));
end

if order >= 7
    fx{7}{1} = @(x,y,z) -35*x.^6-5*y.^6+120*y.^4.*z.^2-240*y.^2.*z.^4+64*z.^6-75*x.^4.*(y.^2-8*z.^2)-45*x.^2.*(y.^4-16*y.^2.*z.^2+16*z.^4);  fy{7}{1} = @(x,y,z) 30*x.*y.*(-33*z.^4+18*z.^2.*(x.^2+y.^2+z.^2)-(x.^2+y.^2+z.^2).^2);  fz{7}{1} = @(x,y,z) 48*x.*z.*(33*z.^4-30*z.^2.*(x.^2+y.^2+z.^2)+5*(x.^2+y.^2+z.^2).^2);
    fx{7}{2} = @(x,y,z) 2*x.*z.*(45*x.^4-15*y.^4+48*z.^4+10*x.^2.*(3*y.^2-16*z.^2));  fy{7}{2} = @(x,y,z) -2*y.*z.*(-15*x.^4+30*x.^2.*y.^2+45*y.^4-160*y.^2.*z.^2+48*z.^4);  fz{7}{2} = @(x,y,z) 15*(x.^2-y.^2).*(33*z.^4-18*z.^2.*(x.^2+y.^2+z.^2)+(x.^2+y.^2+z.^2).^2);
    fx{7}{3} = @(x,y,z) 3*(7*x.^6-3*y.^6+60*y.^4.*z.^2-80*y.^2.*z.^4-5*x.^4.*(y.^2+20*z.^2)+x.^2.*(-15*y.^4+120*y.^2.*z.^2+80*z.^4));  fy{7}{3} = @(x,y,z) -6*x.*y.*(x.^4+9*y.^4-120*y.^2.*z.^2+80*z.^4+10*x.^2.*(y.^2-4*z.^2));  fz{7}{3} = @(x,y,z) -40*(x.^3-3*x.*y.^2).*z.*(3*x.^2+3*y.^2-8*z.^2);
    fx{7}{4} = @(x,y,z) -22*x.*z.*(9*x.^4-15*y.^2.*(y.^2-4*z.^2)-10*x.^2.*(3*y.^2+2*z.^2));  fy{7}{4} = @(x,y,z) 22*y.*z.*(15*x.^4-9*y.^4+20*y.^2.*z.^2+30*x.^2.*(y.^2-2*z.^2));  fz{7}{4} = @(x,y,z) -33*(x.^4-6*x.^2.*y.^2+y.^4).*(x.^2+y.^2-10*z.^2);
    fx{7}{5} = @(x,y,z) -11*(7*x.^6+5*y.^4.*(y.^2-12*z.^2)-15*x.^4.*(3*y.^2+4*z.^2)-15*x.^2.*(y.^4-24*y.^2.*z.^2));  fy{7}{5} = @(x,y,z) 22*x.*y.*(9*x.^4+10*x.^2.*(y.^2-12*z.^2)-15*(y.^4-8*y.^2.*z.^2));  fz{7}{5} = @(x,y,z) 264*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*z;
    fx{7}{6} = @(x,y,z) 6*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*z;  fy{7}{6} = @(x,y,z) -6*(5*x.^4.*y-10*x.^2.*y.^3+y.^5).*z;  fz{7}{6} = @(x,y,z) x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6;
    fx{7}{7} = @(x,y,z) 7*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6); fy{7}{7} = @(x,y,z) -14*x.*y.*(3*x.^4-10*x.^2.*y.^2+3*y.^4);  fz{7}{7} = @(x,y,z) zeros(size(x));
end

if order >= 8
    fx{8}{1} = @(x,y,z) z.*(-245*x.^6-35*y.^6+280*y.^4.*z.^2-336*y.^2.*z.^4+64*z.^6-175*x.^4.*(3*y.^2-8*z.^2)-21*x.^2.*(15*y.^4-80*y.^2.*z.^2+48*z.^4));  fy{8}{1} = @(x,y,z) 14*x.*y.*z.*(-143*z.^4+110*z.^2.*(x.^2+y.^2+z.^2)-15*(x.^2+y.^2+z.^2).^2);  fz{8}{1} = @(x,y,z) 7*x.*(429*z.^6-495*z.^4.*(x.^2+y.^2+z.^2)+135*z.^2.*(x.^2+y.^2+z.^2).^2-5*(x.^2+y.^2+z.^2).^3);
    fx{8}{2} = @(x,y,z) -4*x.*(2*x.^6-y.^6+15*y.^4.*z.^2-16*z.^6+3*x.^4.*(y.^2-15*z.^2)+x.^2.*(-30*y.^2.*z.^2+80*z.^4));  fy{8}{2} = @(x,y,z) -4*y.*(x.^6-2*y.^6-15*x.^4.*z.^2+45*y.^4.*z.^2-80*y.^2.*z.^4+16*z.^6-3*x.^2.*(y.^4-10*y.^2.*z.^2));  fz{8}{2} = @(x,y,z) (x.^2-y.^2).*(572*z.^5-440*z.^3.*(x.^2+y.^2+z.^2)+60*z.*(x.^2+y.^2+z.^2).^2);
    fx{8}{3} = @(x,y,z) z.*(21*x.^6-9*y.^6+60*y.^4.*z.^2-48*y.^2.*z.^4-5*x.^4.*(3*y.^2+20*z.^2)+x.^2.*(-45*y.^4+120*y.^2.*z.^2+48*z.^4));  fy{8}{3} = @(x,y,z) -2*x.*y.*z.*(3*x.^4+10*x.^2.*(3*y.^2-4*z.^2)+3*(9*y.^4-40*y.^2.*z.^2+16*z.^4));  fz{8}{3} = @(x,y,z) (x.^3-3*x.*y.^2).*(143*z.^4-66*z.^2.*(x.^2+y.^2+z.^2)+3*(x.^2+y.^2+z.^2).^2);
    fx{8}{4} = @(x,y,z) 8*(x.^7-3*x.^5.*(y.^2+6*z.^2)-5*x.^3.*(y.^4-12*y.^2.*z.^2-4*z.^4)-x.*(y.^6-30*y.^4.*z.^2+60*y.^2.*z.^4));  fy{8}{4} = @(x,y,z) -8*y.*(x.^6+5*x.^4.*(y.^2-6*z.^2)+3*x.^2.*(y.^4-20*y.^2.*z.^2+20*z.^4)-y.^2.*(y.^4-18*y.^2.*z.^2+20*z.^4));  fz{8}{4} = @(x,y,z) -16*(x.^4-6*x.^2.*y.^2+y.^4).*z.*(3*x.^2+3*y.^2-10*z.^2);
    fx{8}{5} = @(x,y,z) z.*(-7*x.^6-5*y.^4.*(y.^2-4*z.^2)+5*x.^4.*(9*y.^2+4*z.^2)+15*x.^2.*(y.^4-8*y.^2.*z.^2));  fy{8}{5} = @(x,y,z) 2*x.*y.*z.*(9*x.^4-15*y.^4+40*y.^2.*z.^2+10*x.^2.*(y.^2-4*z.^2));  fz{8}{5} = @(x,y,z) -(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*(x.^2+y.^2-12*z.^2);
    fx{8}{6} = @(x,y,z) -8*x.^7-840*x.^3.*y.^2.*z.^2+84*x.^5.*(y.^2+z.^2)-28*x.*(y.^6-15*y.^4.*z.^2);  fy{8}{6} = @(x,y,z) 4*y.*(7*x.^6+2*y.^6-105*x.^4.*z.^2-21*y.^4.*z.^2-21*x.^2.*(y.^4-10*y.^2.*z.^2));  fz{8}{6} = @(x,y,z) 28*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6).*z;
    fx{8}{7} = @(x,y,z) 7*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6).*z;  fy{8}{7} = @(x,y,z) -14*(3*x.^5.*y-10*x.^3.*y.^3+3*x.*y.^5).*z;  fz{8}{7} = @(x,y,z) x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6;
    fx{8}{8} = @(x,y,z) 8*(x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6);  fy{8}{8} = @(x,y,z) 8*y.*(-7*x.^6+35*x.^4.*y.^2-21*x.^2.*y.^4+y.^6);  fz{8}{8} = @(x,y,z) zeros(size(x));
end

if order >= 9
    fx{9}{1} = @(x,y,z) 63*x.^8+7*y.^8-280*y.^6.*z.^2+1120*y.^4.*z.^4-896*y.^2.*z.^6+128*z.^8+196*x.^6.*(y.^2-10*z.^2)+70*x.^4.*(3*y.^4-60*y.^2.*z.^2+80*z.^4)+84*x.^2.*(y.^6-30*y.^4.*z.^2+80*y.^2.*z.^4-32*z.^6);  fy{9}{1} = @(x,y,z) 56*x.*y.*(-143*z.^6+143*z.^4.*(x.^2+y.^2+z.^2)-33*z.^2.*(x.^2+y.^2+z.^2).^2+(x.^2+y.^2+z.^2).^3);  fz{9}{1} = @(x,y,z) 16*x.*z.*(715*z.^6-1001*z.^4.*(x.^2+y.^2+z.^2)+385*z.^2.*(x.^2+y.^2+z.^2).^2-35*(x.^2+y.^2+z.^2).^3);
    fx{9}{2} = @(x,y,z) -4*x.*z.*(14*x.^6-7*y.^6+35*y.^4.*z.^2-16*z.^6+21*x.^4.*(y.^2-5*z.^2)-14*x.^2.*(5*y.^2.*z.^2-8*z.^4));  fy{9}{2} = @(x,y,z) 4*y.*z.*(-7*x.^6+14*y.^6+35*x.^4.*z.^2-105*y.^4.*z.^2+112*y.^2.*z.^4-16*z.^6+7*x.^2.*(3*y.^4-10*y.^2.*z.^2));  fz{9}{2} = @(x,y,z) 7*(x.^2-y.^2).*(143*z.^6-143*z.^4.*(x.^2+y.^2+z.^2)+33*z.^2.*(x.^2+y.^2+z.^2).^2-(x.^2+y.^2+z.^2).^3);
    fx{9}{3} = @(x,y,z) 3*(-3*x.^8+y.^8+84*x.^6.*z.^2-36*y.^6.*z.^2+120*y.^4.*z.^4-64*y.^2.*z.^6+10*x.^4.*(y.^4-6*y.^2.*z.^2-20*z.^4)+4*x.^2.*(2*y.^6-45*y.^4.*z.^2+60*y.^2.*z.^4+16*z.^6));  fy{9}{3} = @(x,y,z) 24*x.*y.*(y.^6-27*y.^4.*z.^2+60*y.^2.*z.^4-16*z.^6+x.^4.*(y.^2-3*z.^2)+2*x.^2.*(y.^4-15*y.^2.*z.^2+10*z.^4));  fz{9}{3} = @(x,y,z) (x.^3-3*x.*y.^2).*(936*z.^5-624*z.^3.*(x.^2+y.^2+z.^2)+72*z.*(x.^2+y.^2+z.^2).^2);
    fx{9}{4} = @(x,y,z) 8*x.*z.*(x.^6-3*x.^4.*(y.^2+2*z.^2)+x.^2.*(-5*y.^4+20*y.^2.*z.^2+4*z.^4)-y.^2.*(y.^4-10*y.^2.*z.^2+12*z.^4));  fy{9}{4} = @(x,y,z) -8*y.*z.*(x.^6+5*x.^4.*(y.^2-2*z.^2)-y.^2.*(y.^4-6*y.^2.*z.^2+4*z.^4)+x.^2.*(3*y.^4-20*y.^2.*z.^2+12*z.^4));  fz{9}{4} = @(x,y,z) (x.^4-6*x.^2.*y.^2+y.^4).*(65*z.^4-26*z.^2.*(x.^2+y.^2+z.^2)+(x.^2+y.^2+z.^2).^2);
    fx{9}{5} = @(x,y,z) 4*x.*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*(x.^2+y.^2-14*z.^2)+5*(x.^4-6*x.^2.*y.^2+y.^4).*(85*z.^4-30*z.^2.*(x.^2+y.^2+z.^2)+(x.^2+y.^2+z.^2).^2);  fy{9}{5} = @(x,y,z) -8*x.*y.*(2*x.^6+7*x.^4.*(y.^2-9*z.^2)-70*x.^2.*z.^2.*(y.^2-2*z.^2)-5*(y.^6-21*y.^4.*z.^2+28*y.^2.*z.^4));  fz{9}{5} = @(x,y,z) -56*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*z.*(x.^2+y.^2-4*z.^2);
    fx{9}{6} = @(x,y,z) -12*x.*z.*(2*x.^6+70*x.^2.*y.^2.*z.^2-7*x.^4.*(3*y.^2+z.^2)+7*(y.^6-5*y.^4.*z.^2));  fy{9}{6} = @(x,y,z) 12*y.*z.*(7*x.^6+2*y.^6-35*x.^4.*z.^2-7*y.^4.*z.^2+x.^2.*(-21*y.^4+70*y.^2.*z.^2));  fz{9}{6} = @(x,y,z) -3*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6).*(x.^2+y.^2-14*z.^2);
    fx{9}{7} = @(x,y,z) -9*x.^8+28*x.^6.*(5*y.^2+4*z.^2)-70*x.^4.*(y.^4+24*y.^2.*z.^2)-84*x.^2.*(y.^6-20*y.^4.*z.^2)+7*(y.^8-16*y.^6.*z.^2);  fy{9}{7} = @(x,y,z) 8*x.*y.*(5*x.^6+7*y.^4.*(y.^2-12*z.^2)-7*x.^4.*(y.^2+12*z.^2)-7*x.^2.*(3*y.^4-40*y.^2.*z.^2));  fz{9}{7} = @(x,y,z) 32*(x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6).*z;
    fx{9}{8} = @(x,y,z) 8*(x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6).*z;  fy{9}{8} = @(x,y,z) -8*(7*x.^6.*y-35*x.^4.*y.^3+21*x.^2.*y.^5-y.^7).*z;  fz{9}{8} = @(x,y,z) x.^8-28*x.^6.*y.^2+70*x.^4.*y.^4-28*x.^2.*y.^6+y.^8;  
    fx{9}{9} = @(x,y,z) 9*(x.^8-28*x.^6.*y.^2+70*x.^4.*y.^4-28*x.^2.*y.^6+y.^8);  fy{9}{9} = @(x,y,z) -72*x.*y.*(x.^6-7*x.^4.*y.^2+7*x.^2.*y.^4-y.^6);  fz{9}{9} = @(x,y,z) zeros(size(x));
end

if order >=10
    fx{10}{1} = @(x,y,z) 567*x.^8.*z+63*y.^8.*z-840*y.^6.*z.^3+2016*y.^4.*z.^5-1152*y.^2.*z.^7+128*z.^9+588*x.^6.*(3*y.^2.*z-10*z.^3)+630*x.^4.*(3*y.^4.*z-20*y.^2.*z.^3+16*z.^5)+108*x.^2.*(7*y.^6.*z-70*y.^4.*z.^3+112*y.^2.*z.^5-32*z.^7);  fy{10}{1} = @(x,y,z) 72*x.*y.*z.*(-221*z.^6+273*z.^4.*(x.^2+y.^2+z.^2)-91*z.^2.*(x.^2+y.^2+z.^2).^2+7*(x.^2+y.^2+z.^2).^3);  fz{10}{1} = @(x,y,z) 9*x.*(2431*z.^8-4004*z.^6.*(x.^2+y.^2+z.^2)+2002*z.^4.*(x.^2+y.^2+z.^2).^2-308*z.^2.*(x.^2+y.^2+z.^2).^3+7*(x.^2+y.^2+z.^2).^4);
    fx{10}{2} = @(x,y,z) 2*x.*(35*x.^8-21*y.^8+672*y.^6.*z.^2-1680*y.^4.*z.^4+384*z.^8+84*x.^6.*(y.^2-16*z.^2)+42*x.^4.*(y.^4-48*y.^2.*z.^2+120*z.^4)-28*x.^2.*(y.^6-120*y.^2.*z.^4+128*z.^6));  fy{10}{2} = @(x,y,z) 2*y.*(21*x.^8-35*y.^8+1344*y.^6.*z.^2-5040*y.^4.*z.^4+3584*y.^2.*z.^6-384*z.^8+28*x.^6.*(y.^2-24*z.^2)-42*x.^4.*(y.^4-40*z.^4)-84*x.^2.*(y.^6-24*y.^4.*z.^2+40*y.^2.*z.^4));  fz{10}{2} = @(x,y,z) 96*(x.^2-y.^2).*z.*(221*z.^6-273*z.^4.*(x.^2+y.^2+z.^2)+91*z.^2.*(x.^2+y.^2+z.^2).^2-7*(x.^2+y.^2+z.^2).^3);
    fx{10}{3} = @(x,y,z) 3*(-21*x.^8.*z+7*y.^8.*z+196*x.^6.*z.^3-84*y.^6.*z.^3+168*y.^4.*z.^5-64*y.^2.*z.^7+70*x.^4.*z.*(y.^4-2*y.^2.*z.^2-4*z.^4)+4*x.^2.*(14*y.^6.*z-105*y.^4.*z.^3+84*y.^2.*z.^5+16*z.^7));  fy{10}{3} = @(x,y,z) 24*x.*y.*z.*(7*y.^6-63*y.^4.*z.^2+84*y.^2.*z.^4-16*z.^6+7*x.^4.*(y.^2-z.^2)+14*x.^2.*(y.^4-5*y.^2.*z.^2+2*z.^4));  fz{10}{3} = @(x,y,z) 7*(x.^3-3*x.*y.^2).*(221*z.^6-195*z.^4.*(x.^2+y.^2+z.^2)+39*z.^2.*(x.^2+y.^2+z.^2).^2-(x.^2+y.^2+z.^2).^3);
    fx{10}{4} = @(x,y,z) -10*x.^9+24*x.^7.*(y.^2+14*z.^2)+84*x.^5.*(y.^4-12*y.^2.*z.^2-12*z.^4)+56*x.^3.*(y.^6-30*y.^4.*z.^2+60*y.^2.*z.^4+8*z.^6)+6*x.*(y.^8-56*y.^6.*z.^2+280*y.^4.*z.^4-224*y.^2.*z.^6);  fy{10}{4} = @(x,y,z) 6*x.^8.*y-10*y.^9+336*y.^7.*z.^2-1008*y.^5.*z.^4+448*y.^3.*z.^6+56*x.^6.*(y.^3-6*y.*z.^2)+84*x.^4.*(y.^5-20*y.^3.*z.^2+20*y.*z.^4)+24*x.^2.*(y.^7-42*y.^5.*z.^2+140*y.^3.*z.^4-56*y.*z.^6);  fz{10}{4} = @(x,y,z) 84*(x.^4-6*x.^2.*y.^2+y.^4).*z.*(x.^4+y.^4-8*y.^2.*z.^2+8*z.^4+2*x.^2.*(y.^2-4*z.^2));
    fx{10}{5} = @(x,y,z) 20*x.*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*z.*(3*x.^2+3*y.^2-14*z.^2)+5*(x.^4-6*x.^2.*y.^2+y.^4).*(323*z.^5-170*z.^3.*(x.^2+y.^2+z.^2)+15*z.*(x.^2+y.^2+z.^2).^2);  fy{10}{5} = @(x,y,z) -40*x.*y.*z.*(6*x.^6+21*x.^4.*(y.^2-3*z.^2)-3*y.^2.*(5*y.^4-35*y.^2.*z.^2+28*z.^4)+x.^2.*(-70*y.^2.*z.^2+84*z.^4));  fz{10}{5} = @(x,y,z) 15*(x.^5-10*x.^3.*y.^2+5*x.*y.^4).*(85*z.^4-30*z.^2.*(x.^2+y.^2+z.^2)+(x.^2+y.^2+z.^2).^2);
    fx{10}{6} = @(x,y,z) 6*x.*(5*x.^8+13*y.^8-448*y.^6.*z.^2+1120*y.^4.*z.^4-4*x.^6.*(13*y.^2+32*z.^2)-14*x.^4.*(3*y.^4-96*y.^2.*z.^2-16*z.^4)+28*x.^2.*(y.^6-80*y.^2.*z.^4));  fy{10}{6} = @(x,y,z) -6*y.*(13*x.^8+5*y.^8-128*y.^6.*z.^2+224*y.^4.*z.^4+28*x.^6.*(y.^2-16*z.^2)-14*x.^4.*(3*y.^4-80*z.^4)-4*x.^2.*(13*y.^6-336*y.^4.*z.^2+560*y.^2.*z.^4));  fz{10}{6} = @(x,y,z) -64*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6).*z.*(3*x.^2+3*y.^2-14*z.^2);
    fx{10}{7} = @(x,y,z) -6*x.*(x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6).*z-7*(x.^6-15*x.^4.*y.^2+15*x.^2.*y.^4-y.^6).*z.*(3*x.^2+3*y.^2-16*z.^2);  fy{10}{7} = @(x,y,z) 8*x.*y.*z.*(15*x.^6-21*x.^4.*(y.^2+4*z.^2)-7*x.^2.*(9*y.^4-40*y.^2.*z.^2)+21*(y.^6-4*y.^4.*z.^2));  fz{10}{7} = @(x,y,z) -3*(x.^7-21*x.^5.*y.^2+35*x.^3.*y.^4-7*x.*y.^6).*(x.^2+y.^2-16*z.^2);
    fx{10}{8} = @(x,y,z) -2*x.*(5*x.^8-27*y.^8+504*y.^6.*z.^2-36*x.^6.*(3*y.^2+2*z.^2)+126*x.^4.*(y.^4+12*y.^2.*z.^2)+84*x.^2.*(y.^6-30*y.^4.*z.^2));  fy{10}{8} = @(x,y,z) -2*y.*(-27*x.^8+5*y.^8-72*y.^6.*z.^2+84*x.^6.*(y.^2+6*z.^2)+126*x.^4.*(y.^4-20*y.^2.*z.^2)-108*x.^2.*(y.^6-14*y.^4.*z.^2));  fz{10}{8} = @(x,y,z) 36*(x.^8-28*x.^6.*y.^2+70*x.^4.*y.^4-28*x.^2.*y.^6+y.^8).*z;
    fx{10}{9} = @(x,y,z) 9*(x.^8-28*x.^6.*y.^2+70*x.^4.*y.^4-28*x.^2.*y.^6+y.^8).*z;  fy{10}{9} = @(x,y,z) -72*x.*y.*(x.^6-7*x.^4.*y.^2+7*x.^2.*y.^4-y.^6).*z;  fz{10}{9} = @(x,y,z) x.^9-36*x.^7.*y.^2+126*x.^5.*y.^4-84*x.^3.*y.^6+9*x.*y.^8;
    fx{10}{10} = @(x,y,z) 10*(x.^9-36*x.^7.*y.^2+126*x.^5.*y.^4-84*x.^3.*y.^6+9*x.*y.^8);  fy{10}{10} = @(x,y,z) -10*(9*x.^8.*y-84*x.^6.*y.^3+126*x.^4.*y.^5-36*x.^2.*y.^7+y.^9);  fz{10}{10} = @(x,y,z) zeros(size(x));
end

end