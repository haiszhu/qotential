function [tt, ww] = neighQuad (a, b, x0, flag)
% a subroutine modified based on "Kolm-Rokhlin for a smooth contour" Matlab 
% code associated with paper "High-order accurate methods for Nystrom 
% discretization of integral equations on smooth curves in the plane"
% by S.Hao, A. Barnett, P.G. Martinsson, P. Young
%
% 

if (strcmp(flag, 'left') == 1)
  [tt, ww] = neigh_quad_sing_left(x0,a,b);
else
  [tt, ww] = neigh_quad_sing_right(x0,a,b);  
end

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [x w] = neigh_quad_sing_left(x0,a,b)

% x0 < a
d = (a - x0)/(b - a);

% Select the appropriate quadrature rule

if(d >= 1e-1)
    
  x(1,1) = 3.9162163294152522e-02;
  x(2,1) = 8.1352339835300810e-02;
  x(3,1) = 1.1234482113449940e-01;
  x(4,1) = 1.5959319839650299e-01;
  x(5,1) = 2.0857590278313490e-01;
  x(6,1) = 2.4262419620275599e-01;
  x(7,1) = 2.8861903125385219e-01;
  x(8,1) = 3.4690217623546749e-01;
  x(9,1) = 4.0729101015696112e-01;
  x(10,1) = 4.6640197225954422e-01;
  x(11,1) = 5.1821208178441125e-01;
  x(12,1) = 5.5013084367716536e-01;
  x(13,1) = 5.9703029808546082e-01;
  x(14,1) = 6.5484579603882087e-01;
  x(15,1) = 7.1195421261060055e-01;
  x(16,1) = 7.6079204209463402e-01;
  x(17,1) = 7.9530170511556841e-01;
  x(18,1) = 8.3039003415170876e-01;
  x(19,1) = 8.6127249190093935e-01;
  x(20,1) = 8.9540491280270795e-01;
  x(21,1) = 9.3159093691553585e-01;
  x(22,1) = 9.6217422490683557e-01;
  x(23,1) = 9.8436634463805994e-01;
  x(24,1) = 9.9700874258233985e-01;
  
  w(1,1) = 4.8807552969181163e-02;
  w(2,1) = 3.1960027851636111e-02;
  w(3,1) = 3.8834166425073618e-02;
  w(4,1) = 5.1488989921408199e-02;
  w(5,1) = 4.2193281487635327e-02;
  w(6,1) = 3.4206862136337890e-02;
  w(7,1) = 5.5124886807192387e-02;
  w(8,1) = 6.0071128098434179e-02;
  w(9,1) = 6.0223504794151797e-02;
  w(10,1) = 5.7350220044014778e-02;
  w(11,1) = 4.1679234171180683e-02;
  w(12,1) = 3.3460896288795998e-02;
  w(13,1) = 5.5747162184237961e-02;
  w(14,1) = 5.8478382433444727e-02;
  w(15,1) = 5.4641569900924739e-02;
  w(16,1) = 4.0921863437049608e-02;
  w(17,1) = 3.2837281660502253e-02;
  w(18,1) = 3.4382332734730951e-02;
  w(19,1) = 3.0225851922264180e-02;
  w(20,1) = 3.7007697012773802e-02;
  w(21,1) = 3.4102136793651622e-02;
  w(22,1) = 2.6657918852741928e-02;
  w(23,1) = 1.7544205263604291e-02;
  w(24,1) = 7.6622831043888671e-03;
    
elseif(d >= 1e-2)
    
  x(1,1) = 1.9405646169375811e-02;
  x(2,1) = 4.5454339923823389e-02;
  x(3,1) = 7.3788666043964196e-02;
  x(4,1) = 1.0541477180776060e-01;
  x(5,1) = 1.4129978884010000e-01;
  x(6,1) = 1.8223255678110811e-01;
  x(7,1) = 2.2872821212024080e-01;
  x(8,1) = 2.8091709255140412e-01;
  x(9,1) = 3.3843209622379700e-01;
  x(10,1) = 4.0031080312440781e-01;
  x(11,1) = 4.6486055716060248e-01;
  x(12,1) = 5.2907149942766873e-01;
  x(13,1) = 5.8296635573863753e-01;
  x(14,1) = 6.1283018899794772e-01;
  x(15,1) = 6.6060721562409619e-01;
  x(16,1) = 7.1394959661285184e-01;
  x(17,1) = 7.6778309149612445e-01;
  x(18,1) = 8.1873824233364501e-01;
  x(19,1) = 8.5870685517394962e-01;
  x(20,1) = 8.9068732855706445e-01;
  x(21,1) = 9.2677724921299032e-01;
  x(22,1) = 9.5921376525823820e-01;
  x(23,1) = 9.8309627127940080e-01;
  x(24,1) = 9.9676215461941475e-01;
  
  w(1,1) = 2.5140221760527950e-02;
  w(2,1) = 2.7035265305356469e-02;
  w(3,1) = 2.9808724876174850e-02;
  w(4,1) = 3.3606262378854890e-02;
  w(5,1) = 3.8296780834166093e-02;
  w(6,1) = 4.3656510457808370e-02;
  w(7,1) = 4.9358463223190457e-02;
  w(8,1) = 5.4959679240552103e-02;
  w(9,1) = 5.9911621987050842e-02;
  w(10,1) = 6.3569608622488893e-02;
  w(11,1) = 6.5068685524671183e-02;
  w(12,1) = 6.2195882352258938e-02;
  w(13,1) = 3.8899860416953098e-02;
  w(14,1) = 3.5734319319406210e-02;
  w(15,1) = 5.2963153683535227e-02;
  w(16,1) = 5.3690339999277588e-02;
  w(17,1) = 5.3407935733672821e-02;
  w(18,1) = 4.7047560139985602e-02;
  w(19,1) = 3.2765763017470681e-02;
  w(20,1) = 3.4491753118800268e-02;
  w(21,1) = 3.5601688482386713e-02;
  w(22,1) = 2.8573671511276610e-02;
  w(23,1) = 1.8940429424422010e-02;
  w(24,1) = 8.2919947702128263e-03;
    
elseif(d >= 1e-3)
    
  x(1,1) = 7.5710978172724274e-03;
  x(2,1) = 1.8006553259767862e-02;
  x(3,1) = 3.0039010045770399e-02;
  x(4,1) = 4.4628821479895747e-02;
  x(5,1) = 6.2957326180926060e-02;
  x(6,1) = 8.6440352419709127e-02;
  x(7,1) = 1.1661648093069200e-01;
  x(8,1) = 1.5466906283949020e-01;
  x(9,1) = 1.9995543466806151e-01;
  x(10,1) = 2.4346833591321190e-01;
  x(11,1) = 2.8008462741460288e-01;
  x(12,1) = 3.3685952578788880e-01;
  x(13,1) = 4.0444183598336481e-01;
  x(14,1) = 4.6850024936344559e-01;
  x(15,1) = 5.1850628170851543e-01;
  x(16,1) = 5.8113141449908456e-01;
  x(17,1) = 6.5457009914505848e-01;
  x(18,1) = 7.2765888614782237e-01;
  x(19,1) = 7.9606260775821680e-01;
  x(20,1) = 8.5720371834033549e-01;
  x(21,1) = 9.0913304850157750e-01;
  x(22,1) = 9.5031316495037377e-01;
  x(23,1) = 9.7957189637931630e-01;
  x(24,1) = 9.9610064791998265e-01;
  
  w(1,1) = 9.8780882013219194e-03;
  w(2,1) = 1.1093168194626741e-02;
  w(3,1) = 1.3133115813218800e-02;
  w(4,1) = 1.6242624420614700e-02;
  w(5,1) = 2.0651684629902141e-02;
  w(6,1) = 2.6577954068253199e-02;
  w(7,1) = 3.3990522990724269e-02;
  w(8,1) = 4.2082146128651701e-02;
  w(9,1) = 4.7325169740427969e-02;
  w(10,1) = 3.6184194158039223e-02;
  w(11,1) = 4.5473468405835778e-02;
  w(12,1) = 6.4631535752428165e-02;
  w(13,1) = 6.8591044578978078e-02;
  w(14,1) = 5.5899179359164511e-02;
  w(15,1) = 5.1992323183352847e-02;
  w(16,1) = 7.0898406444222614e-02;
  w(17,1) = 7.4274003314942397e-02;
  w(18,1) = 7.1253087369317264e-02;
  w(19,1) = 6.5136974746603377e-02;
  w(20,1) = 5.6822985468202643e-02;
  w(21,1) = 4.6780009245070989e-02;
  w(22,1) = 3.5384888866171228e-02;
  w(23,1) = 2.2997234830139549e-02;
  w(24,1) = 9.9935974147335790e-03;

elseif(d >= 1e-4)
    
  x(1,1) = 2.6259613715861529e-03;
  x(2,1) = 6.3093837723922604e-03;
  x(3,1) = 1.0732461334896970e-02;
  x(4,1) = 1.6451704996444019e-02;
  x(5,1) = 2.4338005117777960e-02;
  x(6,1) = 3.5825309259922937e-02;
  x(7,1) = 5.3158273721016620e-02;
  x(8,1) = 7.9173279036144836e-02;
  x(9,1) = 1.1620537074167080e-01;
  x(10,1) = 1.6481391644514490e-01;
  x(11,1) = 2.2319340884888000e-01;
  x(12,1) = 2.8645192938206410e-01;
  x(13,1) = 3.4667294911893998e-01;
  x(14,1) = 4.0761755355281082e-01;
  x(15,1) = 4.8009641075435350e-01;
  x(16,1) = 5.5941050092044597e-01;
  x(17,1) = 6.3953902923528572e-01;
  x(18,1) = 7.1674107821768773e-01;
  x(19,1) = 7.8828071279579393e-01;
  x(20,1) = 8.5193566758212969e-01;
  x(21,1) = 9.0586061772025794e-01;
  x(22,1) = 9.4855397557605670e-01;
  x(23,1) = 9.7885668740940590e-01;
  x(24,1) = 9.9596495069601620e-01;
  
  w(1,1) = 3.4419017371351201e-03;
  w(2,1) = 3.9787997947320700e-03;
  w(3,1) = 4.9584495056449801e-03;
  w(4,1) = 6.6208225019949943e-03;
  w(5,1) = 9.3854964681972224e-03;
  w(6,1) = 1.3965120524391779e-02;
  w(7,1) = 2.1193838324477961e-02;
  w(8,1) = 3.1249893088243021e-02;
  w(9,1) = 4.2914811689163439e-02;
  w(10,1) = 5.4008322782799240e-02;
  w(11,1) = 6.1974246743012149e-02;
  w(12,1) = 6.2972216261315703e-02;
  w(13,1) = 5.7949816367642230e-02;
  w(14,1) = 6.6505016144788057e-02;
  w(15,1) = 7.7163793732307334e-02;
  w(16,1) = 8.0478141227596042e-02;
  w(17,1) = 7.9178224349739715e-02;
  w(18,1) = 7.4776460960140553e-02;
  w(19,1) = 6.7934247656520591e-02;
  w(20,1) = 5.9068529689473029e-02;
  w(21,1) = 4.8531085589103150e-02;
  w(22,1) = 3.6662280597103192e-02;
  w(23,1) = 2.3808506495225361e-02;
  w(24,1) = 1.0341862392629450e-02;
 
elseif(d >= 1e-5)
    
  x(1,1) = 7.7594516792422596e-04;
  x(2,1) = 1.9528544101172860e-03;
  x(3,1) = 3.4290538321163949e-03;
  x(4,1) = 5.3011285402629130e-03;
  x(5,1) = 7.8781187752200669e-03;
  x(6,1) = 1.2055370509498290e-02;
  x(7,1) = 1.9658715120555569e-02;
  x(8,1) = 3.4033286419970471e-02;
  x(9,1) = 5.9474303059259569e-02;
  x(10,1) = 9.8735005435314396e-02;
  x(11,1) = 1.5188626819394130e-01;
  x(12,1) = 2.1717243251342591e-01;
  x(13,1) = 2.9199418787350928e-01;
  x(14,1) = 3.7346373532555299e-01;
  x(15,1) = 4.5867100184432880e-01;
  x(16,1) = 5.4480574169996843e-01;
  x(17,1) = 6.2921589819396184e-01;
  x(18,1) = 7.0944158438895866e-01;
  x(19,1) = 7.8324173286323207e-01;
  x(20,1) = 8.4861941413027586e-01;
  x(21,1) = 9.0384691493679381e-01;
  x(22,1) = 9.4748981501946228e-01;
  x(23,1) = 9.7842906629637472e-01;
  x(24,1) = 9.9588433705503709e-01;
  
  w(1,1) = 1.0495917339652630e-03;
  w(2,1) = 1.3149688557113290e-03;
  w(3,1) = 1.6514750725472960e-03;
  w(4,1) = 2.1356456844670289e-03;
  w(5,1) = 3.1650433828566359e-03;
  w(6,1) = 5.4795286886552743e-03;
  w(7,1) = 1.0288170029150960e-02;
  w(8,1) = 1.9232917856140071e-02;
  w(9,1) = 3.2126434387828542e-02;
  w(10,1) = 4.6386268500492288e-02;
  w(11,1) = 5.9606769230684441e-02;
  w(12,1) = 7.0523604054109429e-02;
  w(13,1) = 7.8634510902378357e-02;
  w(14,1) = 8.3817716985951571e-02;
  w(15,1) = 8.6127555540835246e-02;
  w(16,1) = 8.5699384671032636e-02;
  w(17,1) = 8.2710514996957682e-02;
  w(18,1) = 7.7366925678345216e-02;
  w(19,1) = 6.9900129377604606e-02;
  w(20,1) = 6.0566876696676798e-02;
  w(21,1) = 4.9648687067831689e-02;
  w(22,1) = 3.7450269579721772e-02;
  w(23,1) = 2.4297419818898550e-02;
  w(24,1) = 1.0549066161085200e-02;
    
elseif(d >= 1e-6)
    
  x(1,1) = 3.1263771873326371e-04;
  x(2,1) = 7.6712642690721880e-04;
  x(3,1) = 1.3595751605440770e-03;
  x(4,1) = 2.2383132857275580e-03;
  x(5,1) = 3.7702766235833260e-03;
  x(6,1) = 7.1465839560920482e-03;
  x(7,1) = 1.6355152505487192e-02;
  x(8,1) = 3.8280628551012413e-02;
  x(9,1) = 7.6289845002067591e-02;
  x(10,1) = 1.2942553361215950e-01;
  x(11,1) = 1.9498767557615540e-01;
  x(12,1) = 2.6938522978288559e-01;
  x(13,1) = 3.4697624416315381e-01;
  x(14,1) = 4.1227489288954910e-01;
  x(15,1) = 4.6624992022391448e-01;
  x(16,1) = 5.4214027371237838e-01;
  x(17,1) = 6.2488324136554119e-01;
  x(18,1) = 7.0532584967848400e-01;
  x(19,1) = 7.7988413132310486e-01;
  x(20,1) = 8.4615342751633782e-01;
  x(21,1) = 9.0223125249799763e-01;
  x(22,1) = 9.4658998123102767e-01;
  x(23,1) = 9.7805495638238105e-01;
  x(24,1) = 9.9581251491019274e-01;
  
  w(1,1) = 4.1364796828939599e-04;
  w(2,1) = 5.0687143874146492e-04;
  w(3,1) = 7.0089325278427784e-04;
  w(4,1) = 1.1102649229903520e-03;
  w(5,1) = 2.1201083859417611e-03;
  w(6,1) = 5.2490763432062153e-03;
  w(7,1) = 1.4508099389054049e-02;
  w(8,1) = 2.9877240293763430e-02;
  w(9,1) = 4.5932987178637183e-02;
  w(10,1) = 5.9876344755380208e-02;
  w(11,1) = 7.0659535193925468e-02;
  w(12,1) = 7.7299185627762612e-02;
  w(13,1) = 7.5566353401718300e-02;
  w(14,1) = 5.2341236383390367e-02;
  w(15,1) = 6.5321301253930472e-02;
  w(16,1) = 8.1882720801988398e-02;
  w(17,1) = 8.2373548822881615e-02;
  w(18,1) = 7.7957956645638926e-02;
  w(19,1) = 7.0765142720250765e-02;
  w(20,1) = 6.1457887414524057e-02;
  w(21,1) = 5.0443396413394029e-02;
  w(22,1) = 3.8078171184306321e-02;
  w(23,1) = 2.4715490111016258e-02;
  w(24,1) = 1.0732896727267580e-02;
    
elseif(d >= 1e-7)
    
  x(1,1) = 1.0192349063428630e-04;
  x(2,1) = 2.5060872276314473e-04;
  x(3,1) = 4.4614290053442851e-04;
  x(4,1) = 7.4228454212025229e-04;
  x(5,1) = 1.2891960911564559e-03;
  x(6,1) = 2.7392876680248511e-03;
  x(7,1) = 9.0751689699697085e-03;
  x(8,1) = 2.9680052345553581e-02;
  x(9,1) = 6.7817429799626086e-02;
  x(10,1) = 1.2177924744028050e-01;
  x(11,1) = 1.8866253784384709e-01;
  x(12,1) = 2.6506021558448362e-01;
  x(13,1) = 3.4651136083390799e-01;
  x(14,1) = 4.1783741974205357e-01;
  x(15,1) = 4.5976249825111831e-01;
  x(16,1) = 5.3480651114871569e-01;
  x(17,1) = 6.1946401531467277e-01;
  x(18,1) = 7.0134810041723539e-01;
  x(19,1) = 7.7703861756090820e-01;
  x(20,1) = 8.4422117689167941e-01;
  x(21,1) = 9.0102728362918350e-01;
  x(22,1) = 9.4594097827550006e-01;
  x(23,1) = 9.7779054865548765e-01;
  x(24,1) = 9.9576228710416503e-01;
  
  w(1,1) = 1.3497750517465961e-04;
  w(2,1) = 1.6634115501505060e-04;
  w(3,1) = 2.3287821115624240e-04;
  w(4,1) = 3.8047217797840629e-04;
  w(5,1) = 7.9303504529114495e-04;
  w(6,1) = 2.6006947224238540e-03;
  w(7,1) = 1.2122491135992520e-02;
  w(8,1) = 2.9467089757205859e-02;
  w(9,1) = 4.6477719606913902e-02;
  w(10,1) = 6.0953768890092332e-02;
  w(11,1) = 7.2248447258275589e-02;
  w(12,1) = 7.9864296038845650e-02;
  w(13,1) = 8.1432064629005457e-02;
  w(14,1) = 5.0405293570071348e-02;
  w(15,1) = 5.5921376510014179e-02;
  w(16,1) = 8.3980735726567154e-02;
  w(17,1) = 8.4025868702254855e-02;
  w(18,1) = 7.9222234901599520e-02;
  w(19,1) = 7.1779192516919638e-02;
  w(20,1) = 6.2275519994012721e-02;
  w(21,1) = 5.1084072127197580e-02;
  w(22,1) = 3.8547832793335922e-02;
  w(23,1) = 2.5014966508318130e-02;
  w(24,1) = 1.0861768014020671e-02;
    
elseif(d >= 1e-8)
    
  x(1,1) = 3.4217218322475930e-05;
  x(2,1) = 8.5339062554423803e-05;
  x(3,1) = 1.5635246161550110e-04;
  x(4,1) = 2.7466124015755258e-04;
  x(5,1) = 5.4086439312650623e-04;
  x(6,1) = 1.7823820964883331e-03;
  x(7,1) = 1.1012439120523651e-02;
  x(8,1) = 3.5531720248842852e-02;
  x(9,1) = 7.5541704354638015e-02;
  x(10,1) = 1.2957118949416491e-01;
  x(11,1) = 1.9532130377930890e-01;
  x(12,1) = 2.6996805457142220e-01;
  x(13,1) = 3.5036972813710898e-01;
  x(14,1) = 4.3308385964943669e-01;
  x(15,1) = 5.1418016804358779e-01;
  x(16,1) = 5.8950970162060934e-01;
  x(17,1) = 6.5827086723386141e-01;
  x(18,1) = 7.2525436178873204e-01;
  x(19,1) = 7.9141544856137203e-01;
  x(20,1) = 8.5283839358578439e-01;
  x(21,1) = 9.0596965368628779e-01;
  x(22,1) = 9.4846641245783025e-01;
  x(23,1) = 9.7878633131338544e-01;
  x(24,1) = 9.9594829751550973e-01;
  
  w(1,1) = 4.5597308424974529e-05;
  w(2,1) = 5.8403912559747450e-05;
  w(3,1) = 8.7615809006820404e-05;
  w(4,1) = 1.6172646662948720e-04;
  w(5,1) = 4.4335430351692131e-04;
  w(6,1) = 3.1161751113684419e-03;
  w(7,1) = 1.6554944137725951e-02;
  w(8,1) = 3.2425392564616018e-02;
  w(9,1) = 4.7344264639296772e-02;
  w(10,1) = 6.0326146035799520e-02;
  w(11,1) = 7.0699751873738476e-02;
  w(12,1) = 7.8069736212043647e-02;
  w(13,1) = 8.2163505981378684e-02;
  w(14,1) = 8.2612866570928076e-02;
  w(15,1) = 7.8834762166684447e-02;
  w(16,1) = 7.1572051253184013e-02;
  w(17,1) = 6.7030644687544175e-02;
  w(18,1) = 6.7061372737196298e-02;
  w(19,1) = 6.4499841163497343e-02;
  w(20,1) = 5.7754349590881972e-02;
  w(21,1) = 4.8126002390238801e-02;
  w(22,1) = 3.6614158693042242e-02;
  w(23,1) = 2.3863042034464630e-02;
  w(24,1) = 1.0382686955814110e-02;
    
elseif(d >= 1e-9)
    
  x(1,1) = 6.5389879388403741e-06;
  x(2,1) = 2.6134850758474131e-05;
  x(3,1) = 5.6641837206349909e-05;
  x(4,1) = 1.1793741143625690e-04;
  x(5,1) = 3.2991194313341279e-04;
  x(6,1) = 3.6268286075770012e-03;
  x(7,1) = 2.2651029065721549e-02;
  x(8,1) = 5.8967962316803402e-02;
  x(9,1) = 1.0924962778559230e-01;
  x(10,1) = 1.6667016894993930e-01;
  x(11,1) = 2.1968893858988001e-01;
  x(12,1) = 2.7703522600356167e-01;
  x(13,1) = 3.4831639282683291e-01;
  x(14,1) = 4.1532876648372602e-01;
  x(15,1) = 4.6956242196686082e-01;
  x(16,1) = 5.4211293189988408e-01;
  x(17,1) = 6.2388322120557071e-01;
  x(18,1) = 7.0418429722370812e-01;
  x(19,1) = 7.7888170075521101e-01;
  x(20,1) = 8.4538776370470448e-01;
  x(21,1) = 9.0171782519630062e-01;
  x(22,1) = 9.4629993859524020e-01;
  x(23,1) = 9.7793334851802494e-01;
  x(24,1) = 9.9578906871550088e-01;
  
  w(1,1) = 1.5003324210936069e-05;
  w(2,1) = 2.3672346542531578e-05;
  w(3,1) = 4.0072862467064047e-05;
  w(4,1) = 9.4977435014855053e-05;
  w(5,1) = 4.6190670379447273e-04;
  w(6,1) = 9.9853824638080364e-03;
  w(7,1) = 2.8057417446072569e-02;
  w(8,1) = 4.4041061030083983e-02;
  w(9,1) = 5.5484131728210720e-02;
  w(10,1) = 5.6932359963727260e-02;
  w(11,1) = 5.0873073760460019e-02;
  w(12,1) = 6.5937297183797816e-02;
  w(13,1) = 7.3356800089726143e-02;
  w(14,1) = 5.6750295007437349e-02;
  w(15,1) = 6.1179260275412539e-02;
  w(16,1) = 8.0048050670675497e-02;
  w(17,1) = 8.1969917670426051e-02;
  w(18,1) = 7.8002191272004071e-02;
  w(19,1) = 7.0971750775194936e-02;
  w(20,1) = 6.1711932950411719e-02;
  w(21,1) = 5.0686713197160053e-02;
  w(22,1) = 3.8277384238972659e-02;
  w(23,1) = 2.4850637627336199e-02;
  w(24,1) = 1.0792849733295159e-02;
    
elseif(d >= 1e-10)
    
  x(1,1) = 6.7255205597058249e-06;
  x(2,1) = 6.9864241527704613e-06;
  x(3,1) = 1.2173634167143661e-05;
  x(4,1) = 2.6777462196015291e-05;
  x(5,1) = 5.5970363488967408e-05;
  x(6,1) = 2.7293432809430770e-04;
  x(7,1) = 9.4455268062631405e-03;
  x(8,1) = 3.5567250251615418e-02;
  x(9,1) = 7.7655566681778102e-02;
  x(10,1) = 1.3368481506486621e-01;
  x(11,1) = 2.0115769176835499e-01;
  x(12,1) = 2.7727368543149788e-01;
  x(13,1) = 3.5901243626079260e-01;
  x(14,1) = 4.4300740352144619e-01;
  x(15,1) = 5.2473882195745103e-01;
  x(16,1) = 5.9610532387824200e-01;
  x(17,1) = 6.5473311312134086e-01;
  x(18,1) = 7.1922585196289512e-01;
  x(19,1) = 7.8742517890731023e-01;
  x(20,1) = 8.5058520127750448e-01;
  x(21,1) = 9.0478246178943234e-01;
  x(22,1) = 9.4790451317444480e-01;
  x(23,1) = 9.7857705888665825e-01;
  x(24,1) = 9.9591046923401993e-01;
  
  w(1,1) = 8.1283919139740394e-05;
  w(2,1) = -7.7739007357682818e-05;
  w(3,1) = 1.2873864996661929e-05;
  w(4,1) = 1.8955772519145259e-05;
  w(5,1) = 4.7325803521580759e-05;
  w(6,1) = 9.8579096153861615e-04;
  w(7,1) = 1.7568728972700540e-02;
  w(8,1) = 3.4394220179067722e-02;
  w(9,1) = 4.9441883617929699e-02;
  w(10,1) = 6.2197339349977919e-02;
  w(11,1) = 7.2280074369189387e-02;
  w(12,1) = 7.9449863912256877e-02;
  w(13,1) = 8.3476462881780109e-02;
  w(14,1) = 8.3804330201212071e-02;
  w(15,1) = 7.8327682096825058e-02;
  w(16,1) = 6.3007962252429398e-02;
  w(17,1) = 5.9234060145850531e-02;
  w(18,1) = 6.8342935638038102e-02;
  w(19,1) = 6.6603372044997264e-02;
  w(20,1) = 5.9119887510825517e-02;
  w(21,1) = 4.8935753105688942e-02;
  w(22,1) = 3.7082564386295092e-02;
  w(23,1) = 2.4114637846936179e-02;
  w(24,1) = 1.0480871566970199e-02;
    
elseif(d >= 1e-11)
    
  x(1,1) = 2.8287366948778861e-08;
  x(2,1) = 2.3022331575542120e-06;
  x(3,1) = 5.8535871434441779e-06;
  x(4,1) = 1.4515887700832440e-05;
  x(5,1) = 9.7119650992730306e-05;
  x(6,1) = 9.0047619673738477e-03;
  x(7,1) = 3.4420779240355463e-02;
  x(8,1) = 7.5439267815825425e-02;
  x(9,1) = 1.3003733563189129e-01;
  x(10,1) = 1.9551827728033841e-01;
  x(11,1) = 2.6836085466642950e-01;
  x(12,1) = 3.4300291787409010e-01;
  x(13,1) = 4.0850561078036213e-01;
  x(14,1) = 4.6601982704390849e-01;
  x(15,1) = 5.3361247456346994e-01;
  x(16,1) = 5.9852458001064734e-01;
  x(17,1) = 6.5640897196082759e-01;
  x(18,1) = 7.2166660242325653e-01;
  x(19,1) = 7.8937122413437411e-01;
  x(20,1) = 8.5188837820014185e-01;
  x(21,1) = 9.0556880888813440e-01;
  x(22,1) = 9.4831630978405290e-01;
  x(23,1) = 9.7874136927156075e-01;
  x(24,1) = 9.9594132036112282e-01;
  
  w(1,1) = 1.6656026867043249e-05;
  w(2,1) = 2.5774199240392510e-06;
  w(3,1) = 4.9579411127809750e-06;
  w(4,1) = 1.5370747029151069e-05;
  w(5,1) = 4.6400752397979950e-04;
  w(6,1) = 1.7056879381761890e-02;
  w(7,1) = 3.3497249141604728e-02;
  w(8,1) = 4.8202108721190927e-02;
  w(9,1) = 6.0545472863379760e-02;
  w(10,1) = 6.9843543881210571e-02;
  w(11,1) = 7.4987214970147736e-02;
  w(12,1) = 7.2406201450570834e-02;
  w(13,1) = 5.7749253101746931e-02;
  w(14,1) = 6.2385055548379559e-02;
  w(15,1) = 6.9403946770818417e-02;
  w(16,1) = 5.9108434834073853e-02;
  w(17,1) = 6.0597523214541898e-02;
  w(18,1) = 6.8233622377702086e-02;
  w(19,1) = 6.5938396640711633e-02;
  w(20,1) = 5.8530144202431460e-02;
  w(21,1) = 4.8492171009749833e-02;
  w(22,1) = 3.6774178211701147e-02;
  w(23,1) = 2.3925856428442020e-02;
  w(24,1) = 1.0401499396718739e-02;
    
elseif(d >= 1e-12)
    
  x(1,1) = 6.1470638795736640e-07;
  x(2,1) = 2.1029219849858349e-06;
  x(3,1) = 2.1883661174322891e-06;
  x(4,1) = 3.4826029426948802e-06;
  x(5,1) = 2.7680018886086359e-05;
  x(6,1) = 8.9427792157927843e-03;
  x(7,1) = 3.4322183642372529e-02;
  x(8,1) = 7.5309313280266202e-02;
  x(9,1) = 1.2989830485925721e-01;
  x(10,1) = 1.9540207971177029e-01;
  x(11,1) = 2.6829708704364269e-01;
  x(12,1) = 3.4295407040417020e-01;
  x(13,1) = 4.0803997552024218e-01;
  x(14,1) = 4.6525627981547918e-01;
  x(15,1) = 5.3332209992103252e-01;
  x(16,1) = 5.9869823694331248e-01;
  x(17,1) = 6.5647736006035107e-01;
  x(18,1) = 7.2151590320304182e-01;
  x(19,1) = 7.8920982107609405e-01;
  x(20,1) = 8.5176727778069861e-01;
  x(21,1) = 9.0549069956054984e-01;
  x(22,1) = 9.4827360173208231e-01;
  x(23,1) = 9.7872385934793138e-01;
  x(24,1) = 9.9593798528056765e-01;
  
  w(1,1) = 8.7637410950003307e-07;
  w(2,1) = 1.7846967962883731e-05;
  w(3,1) = -1.7953983959838259e-05;
  w(4,1) = 5.1175145671750247e-06;
  w(5,1) = 1.6988635492843899e-04;
  w(6,1) = 1.7019752166720321e-02;
  w(7,1) = 3.3460259725939093e-02;
  w(8,1) = 4.8179496221967121e-02;
  w(9,1) = 6.0551526647100451e-02;
  w(10,1) = 6.9883137308865917e-02;
  w(11,1) = 7.5046022754630667e-02;
  w(12,1) = 7.2309426748741107e-02;
  w(13,1) = 5.7059522597664288e-02;
  w(14,1) = 6.2650211808181616e-02;
  w(15,1) = 6.9936696945236951e-02;
  w(16,1) = 5.9371309869451293e-02;
  w(17,1) = 6.0265720208635673e-02;
  w(18,1) = 6.8152926963747529e-02;
  w(19,1) = 6.5968045906578024e-02;
  w(20,1) = 5.8574837581491943e-02;
  w(21,1) = 4.8532091993969767e-02;
  w(22,1) = 3.6804692141760187e-02;
  w(23,1) = 2.3945617017058531e-02;
  w(24,1) = 1.0410051528905111e-02;
    
elseif(d >= 1e-13)
    
  x(1,1) = 4.5237400152165080e-08;
  x(2,1) = 4.2818552335882792e-07;
  x(3,1) = 1.0369001531561590e-06;
  x(4,1) = 7.8258493257469075e-06;
  x(5,1) = 8.6174197239531122e-03;
  x(6,1) = 3.2688811636375992e-02;
  x(7,1) = 6.9884413914370433e-02;
  x(8,1) = 1.1422023076764420e-01;
  x(9,1) = 1.5964710818332811e-01;
  x(10,1) = 2.1353364189596200e-01;
  x(11,1) = 2.7811002752961511e-01;
  x(12,1) = 3.4333928033644567e-01;
  x(13,1) = 4.0199605955280271e-01;
  x(14,1) = 4.6564156794167871e-01;
  x(15,1) = 5.3348805488942497e-01;
  x(16,1) = 5.9432985289035423e-01;
  x(17,1) = 6.5629687378159240e-01;
  x(18,1) = 7.2503433446014975e-01;
  x(19,1) = 7.9288207377811359e-01;
  x(20,1) = 8.5461030487454659e-01;
  x(21,1) = 9.0737623107627052e-01;
  x(22,1) = 9.4932536598353467e-01;
  x(23,1) = 9.7916068012672586e-01;
  x(24,1) = 9.9602175739575660e-01;
  
  w(1,1) = 4.4181380823667880e-07;
  w(2,1) = 4.3891080586431201e-07;
  w(3,1) = 9.5395851507378659e-07;
  w(4,1) = 5.8239809472004843e-05;
  w(5,1) = 1.6344642635213010e-02;
  w(6,1) = 3.1296821887283180e-02;
  w(7,1) = 4.2124686175894800e-02;
  w(8,1) = 4.5051208977191913e-02;
  w(9,1) = 4.7690697800266843e-02;
  w(10,1) = 6.0385033827689512e-02;
  w(11,1) = 6.6953436726941803e-02;
  w(12,1) = 6.1632987128262373e-02;
  w(13,1) = 5.8777426243575133e-02;
  w(14,1) = 6.8000536377734400e-02;
  w(15,1) = 6.5169181035896473e-02;
  w(16,1) = 5.8537853759260752e-02;
  w(17,1) = 6.6393963256542510e-02;
  w(18,1) = 6.9487383240816963e-02;
  w(19,1) = 6.5388017033742682e-02;
  w(20,1) = 5.7615037516292503e-02;
  w(21,1) = 4.7613448595553103e-02;
  w(22,1) = 3.6070330972682661e-02;
  w(23,1) = 2.3456907208400709e-02;
  w(24,1) = 1.0195574027228540e-02;
    
elseif(d >= 1e-14)
    
  x(1,1) = 6.0259802828010197e-08;
  x(2,1) = 6.4112452629254725e-08;
  x(3,1) = 1.8628155294291291e-07;
  x(4,1) = 2.0291902089064219e-06;
  x(5,1) = 8.9028813070764993e-03;
  x(6,1) = 3.4200890351649117e-02;
  x(7,1) = 7.5086875259315941e-02;
  x(8,1) = 1.2958581230297750e-01;
  x(9,1) = 1.9504098151883351e-01;
  x(10,1) = 2.6797519678126042e-01;
  x(11,1) = 3.4285250621646890e-01;
  x(12,1) = 4.0809413694135482e-01;
  x(13,1) = 4.6466445119000088e-01;
  x(14,1) = 5.3280715172155013e-01;
  x(15,1) = 5.9785087496980005e-01;
  x(16,1) = 6.5212145233509644e-01;
  x(17,1) = 7.1349216706653362e-01;
  x(18,1) = 7.6793178964792841e-01;
  x(19,1) = 8.0297184872084026e-01;
  x(20,1) = 8.5511014358669346e-01;
  x(21,1) = 9.0673191020177668e-01;
  x(22,1) = 9.4877652132933721e-01;
  x(23,1) = 9.7889797965327363e-01;
  x(24,1) = 9.9596848386341985e-01;
  
  w(1,1) = 9.0793536164412342e-07;
  w(2,1) = -8.3903890427738055e-07;
  w(3,1) = 2.7824606774850160e-07;
  w(4,1) = 1.8211158813627250e-05;
  w(5,1) = 1.6958096506603210e-02;
  w(6,1) = 3.3363701460251451e-02;
  w(7,1) = 4.8078986817969710e-02;
  w(8,1) = 6.0476727232114787e-02;
  w(9,1) = 6.9867749061755344e-02;
  w(10,1) = 7.5156082331942875e-02;
  w(11,1) = 7.2642499040376105e-02;
  w(12,1) = 5.6725071684772609e-02;
  w(13,1) = 6.2203163645249637e-02;
  w(14,1) = 7.0323626522938054e-02;
  w(15,1) = 5.7427308047580138e-02;
  w(16,1) = 5.6440754545411517e-02;
  w(17,1) = 6.3186436661503906e-02;
  w(18,1) = 3.9459956104282282e-02;
  w(19,1) = 4.3242008847585271e-02;
  w(20,1) = 5.4782236956090968e-02;
  w(21,1) = 4.7408562508327722e-02;
  w(22,1) = 3.6333140635047508e-02;
  w(23,1) = 2.3727889170888208e-02;
  w(24,1) = 1.0330365886061449e-02;
   
else
    
    disp('Improper variable d selection')
    keyboard
    
end

% Set nodes and weights to their actual values

w = 2*x.*w;
x = x.^2;

% Convert quadrature rule to interval [a,b]

x = a + (b - a)*x;
w = (b - a)*w;

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [x w] = neigh_quad_sing_right(x0,a,b)

% x0 > b
d = (x0 - b)/(b - a);

% Select the appropriate quadrature rule

if(d >= 1e-1)
    
  x(1,1) = 3.9162163294152522e-02;
  x(2,1) = 8.1352339835300810e-02;
  x(3,1) = 1.1234482113449940e-01;
  x(4,1) = 1.5959319839650299e-01;
  x(5,1) = 2.0857590278313490e-01;
  x(6,1) = 2.4262419620275599e-01;
  x(7,1) = 2.8861903125385219e-01;
  x(8,1) = 3.4690217623546749e-01;
  x(9,1) = 4.0729101015696112e-01;
  x(10,1) = 4.6640197225954422e-01;
  x(11,1) = 5.1821208178441125e-01;
  x(12,1) = 5.5013084367716536e-01;
  x(13,1) = 5.9703029808546082e-01;
  x(14,1) = 6.5484579603882087e-01;
  x(15,1) = 7.1195421261060055e-01;
  x(16,1) = 7.6079204209463402e-01;
  x(17,1) = 7.9530170511556841e-01;
  x(18,1) = 8.3039003415170876e-01;
  x(19,1) = 8.6127249190093935e-01;
  x(20,1) = 8.9540491280270795e-01;
  x(21,1) = 9.3159093691553585e-01;
  x(22,1) = 9.6217422490683557e-01;
  x(23,1) = 9.8436634463805994e-01;
  x(24,1) = 9.9700874258233985e-01;
  
  w(1,1) = 4.8807552969181163e-02;
  w(2,1) = 3.1960027851636111e-02;
  w(3,1) = 3.8834166425073618e-02;
  w(4,1) = 5.1488989921408199e-02;
  w(5,1) = 4.2193281487635327e-02;
  w(6,1) = 3.4206862136337890e-02;
  w(7,1) = 5.5124886807192387e-02;
  w(8,1) = 6.0071128098434179e-02;
  w(9,1) = 6.0223504794151797e-02;
  w(10,1) = 5.7350220044014778e-02;
  w(11,1) = 4.1679234171180683e-02;
  w(12,1) = 3.3460896288795998e-02;
  w(13,1) = 5.5747162184237961e-02;
  w(14,1) = 5.8478382433444727e-02;
  w(15,1) = 5.4641569900924739e-02;
  w(16,1) = 4.0921863437049608e-02;
  w(17,1) = 3.2837281660502253e-02;
  w(18,1) = 3.4382332734730951e-02;
  w(19,1) = 3.0225851922264180e-02;
  w(20,1) = 3.7007697012773802e-02;
  w(21,1) = 3.4102136793651622e-02;
  w(22,1) = 2.6657918852741928e-02;
  w(23,1) = 1.7544205263604291e-02;
  w(24,1) = 7.6622831043888671e-03;
    
elseif(d >= 1e-2)
    
  x(1,1) = 1.9405646169375811e-02;
  x(2,1) = 4.5454339923823389e-02;
  x(3,1) = 7.3788666043964196e-02;
  x(4,1) = 1.0541477180776060e-01;
  x(5,1) = 1.4129978884010000e-01;
  x(6,1) = 1.8223255678110811e-01;
  x(7,1) = 2.2872821212024080e-01;
  x(8,1) = 2.8091709255140412e-01;
  x(9,1) = 3.3843209622379700e-01;
  x(10,1) = 4.0031080312440781e-01;
  x(11,1) = 4.6486055716060248e-01;
  x(12,1) = 5.2907149942766873e-01;
  x(13,1) = 5.8296635573863753e-01;
  x(14,1) = 6.1283018899794772e-01;
  x(15,1) = 6.6060721562409619e-01;
  x(16,1) = 7.1394959661285184e-01;
  x(17,1) = 7.6778309149612445e-01;
  x(18,1) = 8.1873824233364501e-01;
  x(19,1) = 8.5870685517394962e-01;
  x(20,1) = 8.9068732855706445e-01;
  x(21,1) = 9.2677724921299032e-01;
  x(22,1) = 9.5921376525823820e-01;
  x(23,1) = 9.8309627127940080e-01;
  x(24,1) = 9.9676215461941475e-01;
  
  w(1,1) = 2.5140221760527950e-02;
  w(2,1) = 2.7035265305356469e-02;
  w(3,1) = 2.9808724876174850e-02;
  w(4,1) = 3.3606262378854890e-02;
  w(5,1) = 3.8296780834166093e-02;
  w(6,1) = 4.3656510457808370e-02;
  w(7,1) = 4.9358463223190457e-02;
  w(8,1) = 5.4959679240552103e-02;
  w(9,1) = 5.9911621987050842e-02;
  w(10,1) = 6.3569608622488893e-02;
  w(11,1) = 6.5068685524671183e-02;
  w(12,1) = 6.2195882352258938e-02;
  w(13,1) = 3.8899860416953098e-02;
  w(14,1) = 3.5734319319406210e-02;
  w(15,1) = 5.2963153683535227e-02;
  w(16,1) = 5.3690339999277588e-02;
  w(17,1) = 5.3407935733672821e-02;
  w(18,1) = 4.7047560139985602e-02;
  w(19,1) = 3.2765763017470681e-02;
  w(20,1) = 3.4491753118800268e-02;
  w(21,1) = 3.5601688482386713e-02;
  w(22,1) = 2.8573671511276610e-02;
  w(23,1) = 1.8940429424422010e-02;
  w(24,1) = 8.2919947702128263e-03;
    
elseif(d >= 1e-3)
    
  x(1,1) = 7.5710978172724274e-03;
  x(2,1) = 1.8006553259767862e-02;
  x(3,1) = 3.0039010045770399e-02;
  x(4,1) = 4.4628821479895747e-02;
  x(5,1) = 6.2957326180926060e-02;
  x(6,1) = 8.6440352419709127e-02;
  x(7,1) = 1.1661648093069200e-01;
  x(8,1) = 1.5466906283949020e-01;
  x(9,1) = 1.9995543466806151e-01;
  x(10,1) = 2.4346833591321190e-01;
  x(11,1) = 2.8008462741460288e-01;
  x(12,1) = 3.3685952578788880e-01;
  x(13,1) = 4.0444183598336481e-01;
  x(14,1) = 4.6850024936344559e-01;
  x(15,1) = 5.1850628170851543e-01;
  x(16,1) = 5.8113141449908456e-01;
  x(17,1) = 6.5457009914505848e-01;
  x(18,1) = 7.2765888614782237e-01;
  x(19,1) = 7.9606260775821680e-01;
  x(20,1) = 8.5720371834033549e-01;
  x(21,1) = 9.0913304850157750e-01;
  x(22,1) = 9.5031316495037377e-01;
  x(23,1) = 9.7957189637931630e-01;
  x(24,1) = 9.9610064791998265e-01;
  
  w(1,1) = 9.8780882013219194e-03;
  w(2,1) = 1.1093168194626741e-02;
  w(3,1) = 1.3133115813218800e-02;
  w(4,1) = 1.6242624420614700e-02;
  w(5,1) = 2.0651684629902141e-02;
  w(6,1) = 2.6577954068253199e-02;
  w(7,1) = 3.3990522990724269e-02;
  w(8,1) = 4.2082146128651701e-02;
  w(9,1) = 4.7325169740427969e-02;
  w(10,1) = 3.6184194158039223e-02;
  w(11,1) = 4.5473468405835778e-02;
  w(12,1) = 6.4631535752428165e-02;
  w(13,1) = 6.8591044578978078e-02;
  w(14,1) = 5.5899179359164511e-02;
  w(15,1) = 5.1992323183352847e-02;
  w(16,1) = 7.0898406444222614e-02;
  w(17,1) = 7.4274003314942397e-02;
  w(18,1) = 7.1253087369317264e-02;
  w(19,1) = 6.5136974746603377e-02;
  w(20,1) = 5.6822985468202643e-02;
  w(21,1) = 4.6780009245070989e-02;
  w(22,1) = 3.5384888866171228e-02;
  w(23,1) = 2.2997234830139549e-02;
  w(24,1) = 9.9935974147335790e-03;

elseif(d >= 1e-4)
    
  x(1,1) = 2.6259613715861529e-03;
  x(2,1) = 6.3093837723922604e-03;
  x(3,1) = 1.0732461334896970e-02;
  x(4,1) = 1.6451704996444019e-02;
  x(5,1) = 2.4338005117777960e-02;
  x(6,1) = 3.5825309259922937e-02;
  x(7,1) = 5.3158273721016620e-02;
  x(8,1) = 7.9173279036144836e-02;
  x(9,1) = 1.1620537074167080e-01;
  x(10,1) = 1.6481391644514490e-01;
  x(11,1) = 2.2319340884888000e-01;
  x(12,1) = 2.8645192938206410e-01;
  x(13,1) = 3.4667294911893998e-01;
  x(14,1) = 4.0761755355281082e-01;
  x(15,1) = 4.8009641075435350e-01;
  x(16,1) = 5.5941050092044597e-01;
  x(17,1) = 6.3953902923528572e-01;
  x(18,1) = 7.1674107821768773e-01;
  x(19,1) = 7.8828071279579393e-01;
  x(20,1) = 8.5193566758212969e-01;
  x(21,1) = 9.0586061772025794e-01;
  x(22,1) = 9.4855397557605670e-01;
  x(23,1) = 9.7885668740940590e-01;
  x(24,1) = 9.9596495069601620e-01;
  
  w(1,1) = 3.4419017371351201e-03;
  w(2,1) = 3.9787997947320700e-03;
  w(3,1) = 4.9584495056449801e-03;
  w(4,1) = 6.6208225019949943e-03;
  w(5,1) = 9.3854964681972224e-03;
  w(6,1) = 1.3965120524391779e-02;
  w(7,1) = 2.1193838324477961e-02;
  w(8,1) = 3.1249893088243021e-02;
  w(9,1) = 4.2914811689163439e-02;
  w(10,1) = 5.4008322782799240e-02;
  w(11,1) = 6.1974246743012149e-02;
  w(12,1) = 6.2972216261315703e-02;
  w(13,1) = 5.7949816367642230e-02;
  w(14,1) = 6.6505016144788057e-02;
  w(15,1) = 7.7163793732307334e-02;
  w(16,1) = 8.0478141227596042e-02;
  w(17,1) = 7.9178224349739715e-02;
  w(18,1) = 7.4776460960140553e-02;
  w(19,1) = 6.7934247656520591e-02;
  w(20,1) = 5.9068529689473029e-02;
  w(21,1) = 4.8531085589103150e-02;
  w(22,1) = 3.6662280597103192e-02;
  w(23,1) = 2.3808506495225361e-02;
  w(24,1) = 1.0341862392629450e-02;
 
elseif(d >= 1e-5)
    
  x(1,1) = 7.7594516792422596e-04;
  x(2,1) = 1.9528544101172860e-03;
  x(3,1) = 3.4290538321163949e-03;
  x(4,1) = 5.3011285402629130e-03;
  x(5,1) = 7.8781187752200669e-03;
  x(6,1) = 1.2055370509498290e-02;
  x(7,1) = 1.9658715120555569e-02;
  x(8,1) = 3.4033286419970471e-02;
  x(9,1) = 5.9474303059259569e-02;
  x(10,1) = 9.8735005435314396e-02;
  x(11,1) = 1.5188626819394130e-01;
  x(12,1) = 2.1717243251342591e-01;
  x(13,1) = 2.9199418787350928e-01;
  x(14,1) = 3.7346373532555299e-01;
  x(15,1) = 4.5867100184432880e-01;
  x(16,1) = 5.4480574169996843e-01;
  x(17,1) = 6.2921589819396184e-01;
  x(18,1) = 7.0944158438895866e-01;
  x(19,1) = 7.8324173286323207e-01;
  x(20,1) = 8.4861941413027586e-01;
  x(21,1) = 9.0384691493679381e-01;
  x(22,1) = 9.4748981501946228e-01;
  x(23,1) = 9.7842906629637472e-01;
  x(24,1) = 9.9588433705503709e-01;
  
  w(1,1) = 1.0495917339652630e-03;
  w(2,1) = 1.3149688557113290e-03;
  w(3,1) = 1.6514750725472960e-03;
  w(4,1) = 2.1356456844670289e-03;
  w(5,1) = 3.1650433828566359e-03;
  w(6,1) = 5.4795286886552743e-03;
  w(7,1) = 1.0288170029150960e-02;
  w(8,1) = 1.9232917856140071e-02;
  w(9,1) = 3.2126434387828542e-02;
  w(10,1) = 4.6386268500492288e-02;
  w(11,1) = 5.9606769230684441e-02;
  w(12,1) = 7.0523604054109429e-02;
  w(13,1) = 7.8634510902378357e-02;
  w(14,1) = 8.3817716985951571e-02;
  w(15,1) = 8.6127555540835246e-02;
  w(16,1) = 8.5699384671032636e-02;
  w(17,1) = 8.2710514996957682e-02;
  w(18,1) = 7.7366925678345216e-02;
  w(19,1) = 6.9900129377604606e-02;
  w(20,1) = 6.0566876696676798e-02;
  w(21,1) = 4.9648687067831689e-02;
  w(22,1) = 3.7450269579721772e-02;
  w(23,1) = 2.4297419818898550e-02;
  w(24,1) = 1.0549066161085200e-02;
    
elseif(d >= 1e-6)
    
  x(1,1) = 3.1263771873326371e-04;
  x(2,1) = 7.6712642690721880e-04;
  x(3,1) = 1.3595751605440770e-03;
  x(4,1) = 2.2383132857275580e-03;
  x(5,1) = 3.7702766235833260e-03;
  x(6,1) = 7.1465839560920482e-03;
  x(7,1) = 1.6355152505487192e-02;
  x(8,1) = 3.8280628551012413e-02;
  x(9,1) = 7.6289845002067591e-02;
  x(10,1) = 1.2942553361215950e-01;
  x(11,1) = 1.9498767557615540e-01;
  x(12,1) = 2.6938522978288559e-01;
  x(13,1) = 3.4697624416315381e-01;
  x(14,1) = 4.1227489288954910e-01;
  x(15,1) = 4.6624992022391448e-01;
  x(16,1) = 5.4214027371237838e-01;
  x(17,1) = 6.2488324136554119e-01;
  x(18,1) = 7.0532584967848400e-01;
  x(19,1) = 7.7988413132310486e-01;
  x(20,1) = 8.4615342751633782e-01;
  x(21,1) = 9.0223125249799763e-01;
  x(22,1) = 9.4658998123102767e-01;
  x(23,1) = 9.7805495638238105e-01;
  x(24,1) = 9.9581251491019274e-01;
  
  w(1,1) = 4.1364796828939599e-04;
  w(2,1) = 5.0687143874146492e-04;
  w(3,1) = 7.0089325278427784e-04;
  w(4,1) = 1.1102649229903520e-03;
  w(5,1) = 2.1201083859417611e-03;
  w(6,1) = 5.2490763432062153e-03;
  w(7,1) = 1.4508099389054049e-02;
  w(8,1) = 2.9877240293763430e-02;
  w(9,1) = 4.5932987178637183e-02;
  w(10,1) = 5.9876344755380208e-02;
  w(11,1) = 7.0659535193925468e-02;
  w(12,1) = 7.7299185627762612e-02;
  w(13,1) = 7.5566353401718300e-02;
  w(14,1) = 5.2341236383390367e-02;
  w(15,1) = 6.5321301253930472e-02;
  w(16,1) = 8.1882720801988398e-02;
  w(17,1) = 8.2373548822881615e-02;
  w(18,1) = 7.7957956645638926e-02;
  w(19,1) = 7.0765142720250765e-02;
  w(20,1) = 6.1457887414524057e-02;
  w(21,1) = 5.0443396413394029e-02;
  w(22,1) = 3.8078171184306321e-02;
  w(23,1) = 2.4715490111016258e-02;
  w(24,1) = 1.0732896727267580e-02;
    
elseif(d >= 1e-7)
    
  x(1,1) = 1.0192349063428630e-04;
  x(2,1) = 2.5060872276314473e-04;
  x(3,1) = 4.4614290053442851e-04;
  x(4,1) = 7.4228454212025229e-04;
  x(5,1) = 1.2891960911564559e-03;
  x(6,1) = 2.7392876680248511e-03;
  x(7,1) = 9.0751689699697085e-03;
  x(8,1) = 2.9680052345553581e-02;
  x(9,1) = 6.7817429799626086e-02;
  x(10,1) = 1.2177924744028050e-01;
  x(11,1) = 1.8866253784384709e-01;
  x(12,1) = 2.6506021558448362e-01;
  x(13,1) = 3.4651136083390799e-01;
  x(14,1) = 4.1783741974205357e-01;
  x(15,1) = 4.5976249825111831e-01;
  x(16,1) = 5.3480651114871569e-01;
  x(17,1) = 6.1946401531467277e-01;
  x(18,1) = 7.0134810041723539e-01;
  x(19,1) = 7.7703861756090820e-01;
  x(20,1) = 8.4422117689167941e-01;
  x(21,1) = 9.0102728362918350e-01;
  x(22,1) = 9.4594097827550006e-01;
  x(23,1) = 9.7779054865548765e-01;
  x(24,1) = 9.9576228710416503e-01;
  
  w(1,1) = 1.3497750517465961e-04;
  w(2,1) = 1.6634115501505060e-04;
  w(3,1) = 2.3287821115624240e-04;
  w(4,1) = 3.8047217797840629e-04;
  w(5,1) = 7.9303504529114495e-04;
  w(6,1) = 2.6006947224238540e-03;
  w(7,1) = 1.2122491135992520e-02;
  w(8,1) = 2.9467089757205859e-02;
  w(9,1) = 4.6477719606913902e-02;
  w(10,1) = 6.0953768890092332e-02;
  w(11,1) = 7.2248447258275589e-02;
  w(12,1) = 7.9864296038845650e-02;
  w(13,1) = 8.1432064629005457e-02;
  w(14,1) = 5.0405293570071348e-02;
  w(15,1) = 5.5921376510014179e-02;
  w(16,1) = 8.3980735726567154e-02;
  w(17,1) = 8.4025868702254855e-02;
  w(18,1) = 7.9222234901599520e-02;
  w(19,1) = 7.1779192516919638e-02;
  w(20,1) = 6.2275519994012721e-02;
  w(21,1) = 5.1084072127197580e-02;
  w(22,1) = 3.8547832793335922e-02;
  w(23,1) = 2.5014966508318130e-02;
  w(24,1) = 1.0861768014020671e-02;
    
elseif(d >= 1e-8)
    
  x(1,1) = 3.4217218322475930e-05;
  x(2,1) = 8.5339062554423803e-05;
  x(3,1) = 1.5635246161550110e-04;
  x(4,1) = 2.7466124015755258e-04;
  x(5,1) = 5.4086439312650623e-04;
  x(6,1) = 1.7823820964883331e-03;
  x(7,1) = 1.1012439120523651e-02;
  x(8,1) = 3.5531720248842852e-02;
  x(9,1) = 7.5541704354638015e-02;
  x(10,1) = 1.2957118949416491e-01;
  x(11,1) = 1.9532130377930890e-01;
  x(12,1) = 2.6996805457142220e-01;
  x(13,1) = 3.5036972813710898e-01;
  x(14,1) = 4.3308385964943669e-01;
  x(15,1) = 5.1418016804358779e-01;
  x(16,1) = 5.8950970162060934e-01;
  x(17,1) = 6.5827086723386141e-01;
  x(18,1) = 7.2525436178873204e-01;
  x(19,1) = 7.9141544856137203e-01;
  x(20,1) = 8.5283839358578439e-01;
  x(21,1) = 9.0596965368628779e-01;
  x(22,1) = 9.4846641245783025e-01;
  x(23,1) = 9.7878633131338544e-01;
  x(24,1) = 9.9594829751550973e-01;
  
  w(1,1) = 4.5597308424974529e-05;
  w(2,1) = 5.8403912559747450e-05;
  w(3,1) = 8.7615809006820404e-05;
  w(4,1) = 1.6172646662948720e-04;
  w(5,1) = 4.4335430351692131e-04;
  w(6,1) = 3.1161751113684419e-03;
  w(7,1) = 1.6554944137725951e-02;
  w(8,1) = 3.2425392564616018e-02;
  w(9,1) = 4.7344264639296772e-02;
  w(10,1) = 6.0326146035799520e-02;
  w(11,1) = 7.0699751873738476e-02;
  w(12,1) = 7.8069736212043647e-02;
  w(13,1) = 8.2163505981378684e-02;
  w(14,1) = 8.2612866570928076e-02;
  w(15,1) = 7.8834762166684447e-02;
  w(16,1) = 7.1572051253184013e-02;
  w(17,1) = 6.7030644687544175e-02;
  w(18,1) = 6.7061372737196298e-02;
  w(19,1) = 6.4499841163497343e-02;
  w(20,1) = 5.7754349590881972e-02;
  w(21,1) = 4.8126002390238801e-02;
  w(22,1) = 3.6614158693042242e-02;
  w(23,1) = 2.3863042034464630e-02;
  w(24,1) = 1.0382686955814110e-02;
    
elseif(d >= 1e-9)
    
  x(1,1) = 6.5389879388403741e-06;
  x(2,1) = 2.6134850758474131e-05;
  x(3,1) = 5.6641837206349909e-05;
  x(4,1) = 1.1793741143625690e-04;
  x(5,1) = 3.2991194313341279e-04;
  x(6,1) = 3.6268286075770012e-03;
  x(7,1) = 2.2651029065721549e-02;
  x(8,1) = 5.8967962316803402e-02;
  x(9,1) = 1.0924962778559230e-01;
  x(10,1) = 1.6667016894993930e-01;
  x(11,1) = 2.1968893858988001e-01;
  x(12,1) = 2.7703522600356167e-01;
  x(13,1) = 3.4831639282683291e-01;
  x(14,1) = 4.1532876648372602e-01;
  x(15,1) = 4.6956242196686082e-01;
  x(16,1) = 5.4211293189988408e-01;
  x(17,1) = 6.2388322120557071e-01;
  x(18,1) = 7.0418429722370812e-01;
  x(19,1) = 7.7888170075521101e-01;
  x(20,1) = 8.4538776370470448e-01;
  x(21,1) = 9.0171782519630062e-01;
  x(22,1) = 9.4629993859524020e-01;
  x(23,1) = 9.7793334851802494e-01;
  x(24,1) = 9.9578906871550088e-01;
  
  w(1,1) = 1.5003324210936069e-05;
  w(2,1) = 2.3672346542531578e-05;
  w(3,1) = 4.0072862467064047e-05;
  w(4,1) = 9.4977435014855053e-05;
  w(5,1) = 4.6190670379447273e-04;
  w(6,1) = 9.9853824638080364e-03;
  w(7,1) = 2.8057417446072569e-02;
  w(8,1) = 4.4041061030083983e-02;
  w(9,1) = 5.5484131728210720e-02;
  w(10,1) = 5.6932359963727260e-02;
  w(11,1) = 5.0873073760460019e-02;
  w(12,1) = 6.5937297183797816e-02;
  w(13,1) = 7.3356800089726143e-02;
  w(14,1) = 5.6750295007437349e-02;
  w(15,1) = 6.1179260275412539e-02;
  w(16,1) = 8.0048050670675497e-02;
  w(17,1) = 8.1969917670426051e-02;
  w(18,1) = 7.8002191272004071e-02;
  w(19,1) = 7.0971750775194936e-02;
  w(20,1) = 6.1711932950411719e-02;
  w(21,1) = 5.0686713197160053e-02;
  w(22,1) = 3.8277384238972659e-02;
  w(23,1) = 2.4850637627336199e-02;
  w(24,1) = 1.0792849733295159e-02;
    
elseif(d >= 1e-10)
    
  x(1,1) = 6.7255205597058249e-06;
  x(2,1) = 6.9864241527704613e-06;
  x(3,1) = 1.2173634167143661e-05;
  x(4,1) = 2.6777462196015291e-05;
  x(5,1) = 5.5970363488967408e-05;
  x(6,1) = 2.7293432809430770e-04;
  x(7,1) = 9.4455268062631405e-03;
  x(8,1) = 3.5567250251615418e-02;
  x(9,1) = 7.7655566681778102e-02;
  x(10,1) = 1.3368481506486621e-01;
  x(11,1) = 2.0115769176835499e-01;
  x(12,1) = 2.7727368543149788e-01;
  x(13,1) = 3.5901243626079260e-01;
  x(14,1) = 4.4300740352144619e-01;
  x(15,1) = 5.2473882195745103e-01;
  x(16,1) = 5.9610532387824200e-01;
  x(17,1) = 6.5473311312134086e-01;
  x(18,1) = 7.1922585196289512e-01;
  x(19,1) = 7.8742517890731023e-01;
  x(20,1) = 8.5058520127750448e-01;
  x(21,1) = 9.0478246178943234e-01;
  x(22,1) = 9.4790451317444480e-01;
  x(23,1) = 9.7857705888665825e-01;
  x(24,1) = 9.9591046923401993e-01;
  
  w(1,1) = 8.1283919139740394e-05;
  w(2,1) = -7.7739007357682818e-05;
  w(3,1) = 1.2873864996661929e-05;
  w(4,1) = 1.8955772519145259e-05;
  w(5,1) = 4.7325803521580759e-05;
  w(6,1) = 9.8579096153861615e-04;
  w(7,1) = 1.7568728972700540e-02;
  w(8,1) = 3.4394220179067722e-02;
  w(9,1) = 4.9441883617929699e-02;
  w(10,1) = 6.2197339349977919e-02;
  w(11,1) = 7.2280074369189387e-02;
  w(12,1) = 7.9449863912256877e-02;
  w(13,1) = 8.3476462881780109e-02;
  w(14,1) = 8.3804330201212071e-02;
  w(15,1) = 7.8327682096825058e-02;
  w(16,1) = 6.3007962252429398e-02;
  w(17,1) = 5.9234060145850531e-02;
  w(18,1) = 6.8342935638038102e-02;
  w(19,1) = 6.6603372044997264e-02;
  w(20,1) = 5.9119887510825517e-02;
  w(21,1) = 4.8935753105688942e-02;
  w(22,1) = 3.7082564386295092e-02;
  w(23,1) = 2.4114637846936179e-02;
  w(24,1) = 1.0480871566970199e-02;
    
elseif(d >= 1e-11)
    
  x(1,1) = 2.8287366948778861e-08;
  x(2,1) = 2.3022331575542120e-06;
  x(3,1) = 5.8535871434441779e-06;
  x(4,1) = 1.4515887700832440e-05;
  x(5,1) = 9.7119650992730306e-05;
  x(6,1) = 9.0047619673738477e-03;
  x(7,1) = 3.4420779240355463e-02;
  x(8,1) = 7.5439267815825425e-02;
  x(9,1) = 1.3003733563189129e-01;
  x(10,1) = 1.9551827728033841e-01;
  x(11,1) = 2.6836085466642950e-01;
  x(12,1) = 3.4300291787409010e-01;
  x(13,1) = 4.0850561078036213e-01;
  x(14,1) = 4.6601982704390849e-01;
  x(15,1) = 5.3361247456346994e-01;
  x(16,1) = 5.9852458001064734e-01;
  x(17,1) = 6.5640897196082759e-01;
  x(18,1) = 7.2166660242325653e-01;
  x(19,1) = 7.8937122413437411e-01;
  x(20,1) = 8.5188837820014185e-01;
  x(21,1) = 9.0556880888813440e-01;
  x(22,1) = 9.4831630978405290e-01;
  x(23,1) = 9.7874136927156075e-01;
  x(24,1) = 9.9594132036112282e-01;
  
  w(1,1) = 1.6656026867043249e-05;
  w(2,1) = 2.5774199240392510e-06;
  w(3,1) = 4.9579411127809750e-06;
  w(4,1) = 1.5370747029151069e-05;
  w(5,1) = 4.6400752397979950e-04;
  w(6,1) = 1.7056879381761890e-02;
  w(7,1) = 3.3497249141604728e-02;
  w(8,1) = 4.8202108721190927e-02;
  w(9,1) = 6.0545472863379760e-02;
  w(10,1) = 6.9843543881210571e-02;
  w(11,1) = 7.4987214970147736e-02;
  w(12,1) = 7.2406201450570834e-02;
  w(13,1) = 5.7749253101746931e-02;
  w(14,1) = 6.2385055548379559e-02;
  w(15,1) = 6.9403946770818417e-02;
  w(16,1) = 5.9108434834073853e-02;
  w(17,1) = 6.0597523214541898e-02;
  w(18,1) = 6.8233622377702086e-02;
  w(19,1) = 6.5938396640711633e-02;
  w(20,1) = 5.8530144202431460e-02;
  w(21,1) = 4.8492171009749833e-02;
  w(22,1) = 3.6774178211701147e-02;
  w(23,1) = 2.3925856428442020e-02;
  w(24,1) = 1.0401499396718739e-02;
    
elseif(d >= 1e-12)
    
  x(1,1) = 6.1470638795736640e-07;
  x(2,1) = 2.1029219849858349e-06;
  x(3,1) = 2.1883661174322891e-06;
  x(4,1) = 3.4826029426948802e-06;
  x(5,1) = 2.7680018886086359e-05;
  x(6,1) = 8.9427792157927843e-03;
  x(7,1) = 3.4322183642372529e-02;
  x(8,1) = 7.5309313280266202e-02;
  x(9,1) = 1.2989830485925721e-01;
  x(10,1) = 1.9540207971177029e-01;
  x(11,1) = 2.6829708704364269e-01;
  x(12,1) = 3.4295407040417020e-01;
  x(13,1) = 4.0803997552024218e-01;
  x(14,1) = 4.6525627981547918e-01;
  x(15,1) = 5.3332209992103252e-01;
  x(16,1) = 5.9869823694331248e-01;
  x(17,1) = 6.5647736006035107e-01;
  x(18,1) = 7.2151590320304182e-01;
  x(19,1) = 7.8920982107609405e-01;
  x(20,1) = 8.5176727778069861e-01;
  x(21,1) = 9.0549069956054984e-01;
  x(22,1) = 9.4827360173208231e-01;
  x(23,1) = 9.7872385934793138e-01;
  x(24,1) = 9.9593798528056765e-01;
  
  w(1,1) = 8.7637410950003307e-07;
  w(2,1) = 1.7846967962883731e-05;
  w(3,1) = -1.7953983959838259e-05;
  w(4,1) = 5.1175145671750247e-06;
  w(5,1) = 1.6988635492843899e-04;
  w(6,1) = 1.7019752166720321e-02;
  w(7,1) = 3.3460259725939093e-02;
  w(8,1) = 4.8179496221967121e-02;
  w(9,1) = 6.0551526647100451e-02;
  w(10,1) = 6.9883137308865917e-02;
  w(11,1) = 7.5046022754630667e-02;
  w(12,1) = 7.2309426748741107e-02;
  w(13,1) = 5.7059522597664288e-02;
  w(14,1) = 6.2650211808181616e-02;
  w(15,1) = 6.9936696945236951e-02;
  w(16,1) = 5.9371309869451293e-02;
  w(17,1) = 6.0265720208635673e-02;
  w(18,1) = 6.8152926963747529e-02;
  w(19,1) = 6.5968045906578024e-02;
  w(20,1) = 5.8574837581491943e-02;
  w(21,1) = 4.8532091993969767e-02;
  w(22,1) = 3.6804692141760187e-02;
  w(23,1) = 2.3945617017058531e-02;
  w(24,1) = 1.0410051528905111e-02;
    
elseif(d >= 1e-13)
    
  x(1,1) = 4.5237400152165080e-08;
  x(2,1) = 4.2818552335882792e-07;
  x(3,1) = 1.0369001531561590e-06;
  x(4,1) = 7.8258493257469075e-06;
  x(5,1) = 8.6174197239531122e-03;
  x(6,1) = 3.2688811636375992e-02;
  x(7,1) = 6.9884413914370433e-02;
  x(8,1) = 1.1422023076764420e-01;
  x(9,1) = 1.5964710818332811e-01;
  x(10,1) = 2.1353364189596200e-01;
  x(11,1) = 2.7811002752961511e-01;
  x(12,1) = 3.4333928033644567e-01;
  x(13,1) = 4.0199605955280271e-01;
  x(14,1) = 4.6564156794167871e-01;
  x(15,1) = 5.3348805488942497e-01;
  x(16,1) = 5.9432985289035423e-01;
  x(17,1) = 6.5629687378159240e-01;
  x(18,1) = 7.2503433446014975e-01;
  x(19,1) = 7.9288207377811359e-01;
  x(20,1) = 8.5461030487454659e-01;
  x(21,1) = 9.0737623107627052e-01;
  x(22,1) = 9.4932536598353467e-01;
  x(23,1) = 9.7916068012672586e-01;
  x(24,1) = 9.9602175739575660e-01;
  
  w(1,1) = 4.4181380823667880e-07;
  w(2,1) = 4.3891080586431201e-07;
  w(3,1) = 9.5395851507378659e-07;
  w(4,1) = 5.8239809472004843e-05;
  w(5,1) = 1.6344642635213010e-02;
  w(6,1) = 3.1296821887283180e-02;
  w(7,1) = 4.2124686175894800e-02;
  w(8,1) = 4.5051208977191913e-02;
  w(9,1) = 4.7690697800266843e-02;
  w(10,1) = 6.0385033827689512e-02;
  w(11,1) = 6.6953436726941803e-02;
  w(12,1) = 6.1632987128262373e-02;
  w(13,1) = 5.8777426243575133e-02;
  w(14,1) = 6.8000536377734400e-02;
  w(15,1) = 6.5169181035896473e-02;
  w(16,1) = 5.8537853759260752e-02;
  w(17,1) = 6.6393963256542510e-02;
  w(18,1) = 6.9487383240816963e-02;
  w(19,1) = 6.5388017033742682e-02;
  w(20,1) = 5.7615037516292503e-02;
  w(21,1) = 4.7613448595553103e-02;
  w(22,1) = 3.6070330972682661e-02;
  w(23,1) = 2.3456907208400709e-02;
  w(24,1) = 1.0195574027228540e-02;
    
elseif(d >= 1e-14)
    
  x(1,1) = 6.0259802828010197e-08;
  x(2,1) = 6.4112452629254725e-08;
  x(3,1) = 1.8628155294291291e-07;
  x(4,1) = 2.0291902089064219e-06;
  x(5,1) = 8.9028813070764993e-03;
  x(6,1) = 3.4200890351649117e-02;
  x(7,1) = 7.5086875259315941e-02;
  x(8,1) = 1.2958581230297750e-01;
  x(9,1) = 1.9504098151883351e-01;
  x(10,1) = 2.6797519678126042e-01;
  x(11,1) = 3.4285250621646890e-01;
  x(12,1) = 4.0809413694135482e-01;
  x(13,1) = 4.6466445119000088e-01;
  x(14,1) = 5.3280715172155013e-01;
  x(15,1) = 5.9785087496980005e-01;
  x(16,1) = 6.5212145233509644e-01;
  x(17,1) = 7.1349216706653362e-01;
  x(18,1) = 7.6793178964792841e-01;
  x(19,1) = 8.0297184872084026e-01;
  x(20,1) = 8.5511014358669346e-01;
  x(21,1) = 9.0673191020177668e-01;
  x(22,1) = 9.4877652132933721e-01;
  x(23,1) = 9.7889797965327363e-01;
  x(24,1) = 9.9596848386341985e-01;
  
  w(1,1) = 9.0793536164412342e-07;
  w(2,1) = -8.3903890427738055e-07;
  w(3,1) = 2.7824606774850160e-07;
  w(4,1) = 1.8211158813627250e-05;
  w(5,1) = 1.6958096506603210e-02;
  w(6,1) = 3.3363701460251451e-02;
  w(7,1) = 4.8078986817969710e-02;
  w(8,1) = 6.0476727232114787e-02;
  w(9,1) = 6.9867749061755344e-02;
  w(10,1) = 7.5156082331942875e-02;
  w(11,1) = 7.2642499040376105e-02;
  w(12,1) = 5.6725071684772609e-02;
  w(13,1) = 6.2203163645249637e-02;
  w(14,1) = 7.0323626522938054e-02;
  w(15,1) = 5.7427308047580138e-02;
  w(16,1) = 5.6440754545411517e-02;
  w(17,1) = 6.3186436661503906e-02;
  w(18,1) = 3.9459956104282282e-02;
  w(19,1) = 4.3242008847585271e-02;
  w(20,1) = 5.4782236956090968e-02;
  w(21,1) = 4.7408562508327722e-02;
  w(22,1) = 3.6333140635047508e-02;
  w(23,1) = 2.3727889170888208e-02;
  w(24,1) = 1.0330365886061449e-02;
   
else
    
    disp('Improper variable d selection')
    keyboard
    
end

% Set nodes and weights to their actual values

w = 2*x.*w;
x = x.^2;

% Flip ordering of nodes to work for singularity on right of panel

x = x(end:-1:1);
x = -x+1;
w = w(end:-1:1);
% 
% Convert quadrature rule to interval [a,b]

x = a + (b - a)*x;
w = (b - a)*w;

end